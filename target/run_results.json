{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-06T22:42:10.929262Z", "invocation_id": "28c0207d-088a-44d4-8d22-12e1d977f282", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-06T22:42:05.006147Z", "completed_at": "2025-04-06T22:42:05.010286Z"}, {"name": "execute", "started_at": "2025-04-06T22:42:05.010550Z", "completed_at": "2025-04-06T22:42:05.984779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9792020320892334, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb8452-0002-a4fa-0000-0007b4969745"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "with  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\n    SELECT * FROM AIRBNB.raw.raw_hosts\n)\n\nSELECT\n    id as host_id,\n    name as host_name,\n    is_superhost,\n    created_at,\n    updated_at\nFROM raw_hosts\n), src_hosts as (\n    select * from __dbt__cte__src_hosts\n)\n\nselect\n    host_id,\n    case \n        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'\n        else host_name  -- Retain the original host_name if not null\n    end as host_name,\n    created_at,\n    updated_at,\n    is_superhost\nfrom src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-06T22:42:05.989368Z", "completed_at": "2025-04-06T22:42:05.994698Z"}, {"name": "execute", "started_at": "2025-04-06T22:42:05.995022Z", "completed_at": "2025-04-06T22:42:06.746297Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7575349807739258, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb8452-0002-a5ed-0000-0007b4968555"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearn.dim_listings_cleansed", "compiled": true, "compiled_code": "with  __dbt__cte__src_listings as (\nwith raw_listings as (\n    select * from AIRBNB.raw.raw_listings\n)\nselect\n    id as listing_id,\n    name as listing_name,\n    listing_url, room_type, minimum_nights, host_id,\n    price as price_str,\n    created_at, updated_at\nfrom \n    raw_listings\n), src_listings as (\n    select * from __dbt__cte__src_listings\n)\n\nselect\n    listing_id, \n    listing_name,\n    room_type,\n    -- Adjust minimum_nights to ensure no listing has a value of 0\n    case \n        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0\n        else minimum_nights  -- Otherwise, keep the original minimum_nights value\n    end as minimum_nights,\n    host_id,\n    -- Remove the dollar sign from the price string\n    replace(\n        price_str,\n        '$'\n    )::number(  -- Convert the resulting string to a number\n        10,\n        2\n    ) as price,\n    created_at,\n    updated_at\nfrom src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-06T22:42:06.749873Z", "completed_at": "2025-04-06T22:42:06.814330Z"}, {"name": "execute", "started_at": "2025-04-06T22:42:06.814535Z", "completed_at": "2025-04-06T22:42:08.090884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3419530391693115, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0, "query_id": "01bb8452-0002-a586-0000-0007b496476d"}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.dbtlearn.fct_reviews", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\n    SELECT * FROM AIRBNB.raw.raw_reviews\n)\n\nSELECT\n    listing_id,\n    date as review_date,\n    reviewer_name,\n    comments as review_text,\n    sentiment as review_sentiment\nFROM raw_reviews\n), src_reviews as (\n    select * from __dbt__cte__src_reviews\n)\n\nselect * from src_reviews\nwhere review_text is not null\n\n    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-06T22:42:08.094614Z", "completed_at": "2025-04-06T22:42:08.097063Z"}, {"name": "execute", "started_at": "2025-04-06T22:42:08.097235Z", "completed_at": "2025-04-06T22:42:08.787391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6933529376983643, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb8452-0002-a5ed-0000-0007b496855d"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\n    l AS (\n        SELECT\n            *\n        FROM\n            AIRBNB.DEV.dim_listings_cleansed\n    ),\n    h AS (\n        SELECT\n            *\n        FROM\n            AIRBNB.DEV.dim_hosts_cleansed\n    )\nSELECT\n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_name,\n    h.is_superhost AS host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) AS updated_at\nFROM\n    l\nLEFT JOIN\n    h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-06T22:42:08.792034Z", "completed_at": "2025-04-06T22:42:08.794691Z"}, {"name": "execute", "started_at": "2025-04-06T22:42:08.794997Z", "completed_at": "2025-04-06T22:42:10.832715Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.04178786277771, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bb8452-0002-a5a0-0000-0007b49667d1"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearn.mart_fullmoon_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews  -- Selecting all records from the fact reviews table\n),\nfull_moon_dates AS (\n    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates  -- Selecting all records from the full moon dates seed\n)\nSELECT\n    r.*,  -- Selecting all columns from the fact reviews\n    CASE\n        WHEN fm.full_moon_date IS NULL THEN 'not full moon'  -- Checking if the full moon date is null\n        ELSE 'full moon'  -- If not null, indicating it is a full moon\n    END AS is_full_moon  -- Creating a new column to indicate full moon status\nFROM\n    fct_reviews r  -- Using the fact reviews as the main table\nLEFT JOIN\n    full_moon_dates fm  -- Left joining with the full moon dates\nON \n    (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))  -- Joining condition to match review dates with full moon dates", "relation_name": "AIRBNB.DEV.mart_fullmoon_reviews", "batch_results": null}], "elapsed_time": 6.6132941246032715, "args": {"log_format_file": "debug", "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "populate_cache": true, "state_modified_compare_vars": false, "require_yaml_configuration_for_mf_time_spines": false, "require_resource_names_without_spaces": false, "partial_parse": true, "printer_width": 80, "exclude": [], "log_level": "info", "use_colors_file": true, "project_dir": "/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn", "show_resource_report": false, "send_anonymous_usage_stats": true, "log_path": "/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs", "which": "run", "log_format": "default", "require_batched_execution_for_custom_microbatch_strategy": false, "print": true, "partial_parse_file_diff": true, "use_colors": true, "version_check": true, "favor_state": false, "defer": false, "log_file_max_bytes": 10485760, "vars": {}, "log_level_file": "debug", "write_json": true, "invocation_command": "dbt run", "introspect": true, "empty": false, "quiet": false, "profiles_dir": "/Users/amanarya/.dbt", "static_parser": true, "require_nested_cumulative_type_params": false, "warn_error_options": {"include": [], "exclude": []}, "cache_selected_only": false, "macro_debugging": false, "strict_mode": false, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "select": [], "source_freshness_run_project_hooks": false}}