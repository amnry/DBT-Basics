[0m16:43:57.775061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c13e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0e000>]}


============================== 16:43:57.778210 | cd7f9207-89fe-4500-8703-08ef9d6ea16f ==============================
[0m16:43:57.778210 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:43:57.778584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:43:57.787364 [info ] [MainThread]: dbt version: 1.9.4
[0m16:43:57.787625 [info ] [MainThread]: python version: 3.12.9
[0m16:43:57.787834 [info ] [MainThread]: python path: /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbt_venv/bin/python3.12
[0m16:43:57.788002 [info ] [MainThread]: os info: macOS-15.3.2-arm64-arm-64bit
[0m16:43:58.223582 [info ] [MainThread]: Using profiles dir at /Users/amanarya/.dbt
[0m16:43:58.223883 [info ] [MainThread]: Using profiles.yml file at /Users/amanarya/.dbt/profiles.yml
[0m16:43:58.224029 [info ] [MainThread]: Using dbt_project.yml file at /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/dbt_project.yml
[0m16:43:58.224297 [info ] [MainThread]: adapter type: snowflake
[0m16:43:58.224481 [info ] [MainThread]: adapter version: 1.9.0
[0m16:43:58.265138 [info ] [MainThread]: Configuration:
[0m16:43:58.265403 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:43:58.265550 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:43:58.265686 [info ] [MainThread]: Required dependencies:
[0m16:43:58.265875 [debug] [MainThread]: Executing "git --help"
[0m16:43:58.288759 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:43:58.289365 [debug] [MainThread]: STDERR: "b''"
[0m16:43:58.289540 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:43:58.289691 [info ] [MainThread]: Connection:
[0m16:43:58.289857 [info ] [MainThread]:   account: kxaooto-ul75867
[0m16:43:58.289971 [info ] [MainThread]:   user: dbt
[0m16:43:58.290091 [info ] [MainThread]:   database: AIRBNB
[0m16:43:58.290187 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m16:43:58.290285 [info ] [MainThread]:   role: transform
[0m16:43:58.290380 [info ] [MainThread]:   schema: DEV
[0m16:43:58.290479 [info ] [MainThread]:   authenticator: None
[0m16:43:58.290573 [info ] [MainThread]:   oauth_client_id: None
[0m16:43:58.290671 [info ] [MainThread]:   query_tag: None
[0m16:43:58.290765 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:43:58.290856 [info ] [MainThread]:   host: None
[0m16:43:58.290956 [info ] [MainThread]:   port: None
[0m16:43:58.291054 [info ] [MainThread]:   proxy_host: None
[0m16:43:58.291147 [info ] [MainThread]:   proxy_port: None
[0m16:43:58.291237 [info ] [MainThread]:   protocol: None
[0m16:43:58.291329 [info ] [MainThread]:   connect_retries: 1
[0m16:43:58.291419 [info ] [MainThread]:   connect_timeout: None
[0m16:43:58.291511 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:43:58.291662 [info ] [MainThread]:   retry_all: False
[0m16:43:58.291829 [info ] [MainThread]:   insecure_mode: False
[0m16:43:58.291955 [info ] [MainThread]:   reuse_connections: True
[0m16:43:58.292306 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:43:58.488414 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:43:58.511125 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:43:58.511325 [debug] [MainThread]: On debug: select 1 as id
[0m16:43:58.511474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:59.613002 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.101 seconds
[0m16:43:59.614498 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:43:59.617194 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:43:59.620123 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8814744, "process_in_blocks": "0", "process_kernel_time": 0.215353, "process_mem_max_rss": "135184384", "process_out_blocks": "0", "process_user_time": 0.991914}
[0m16:43:59.620541 [debug] [MainThread]: Command `dbt debug` succeeded at 16:43:59.620464 after 1.88 seconds
[0m16:43:59.620963 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:43:59.621199 [debug] [MainThread]: On debug: Close
[0m16:43:59.726700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109417380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6eca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9ec260>]}
[0m16:43:59.727293 [debug] [MainThread]: Flushing usage events
[0m16:43:59.783948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:25:32.901295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105200500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105200200>]}


============================== 19:25:32.904164 | d65653a3-bf36-4a3e-ba6f-736ca31e507d ==============================
[0m19:25:32.904164 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:25:32.904501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:25:33.088147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f0fe00>]}
[0m19:25:33.111384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105306240>]}
[0m19:25:33.111920 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:25:33.176413 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:25:33.176863 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:25:33.177045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae7ad0>]}
[0m19:25:33.608919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d75460>]}
[0m19:25:33.632311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:25:33.633903 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:25:33.646624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de5b50>]}
[0m19:25:33.646845 [info ] [MainThread]: Found 1 model, 472 macros
[0m19:25:33.647007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcd100>]}
[0m19:25:33.647709 [info ] [MainThread]: 
[0m19:25:33.647857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:25:33.647970 [info ] [MainThread]: 
[0m19:25:33.648162 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:25:33.648615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:25:33.676968 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:25:33.677148 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:25:33.677282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:25:34.317118 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.640 seconds
[0m19:25:34.319831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m19:25:34.320398 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m19:25:34.325287 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m19:25:34.325592 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m19:25:34.449384 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.123 seconds
[0m19:25:34.452947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m19:25:34.466002 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:25:34.466470 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m19:25:34.580697 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.114 seconds
[0m19:25:34.584217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a3c20>]}
[0m19:25:34.592059 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m19:25:34.592687 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listings ................................... [RUN]
[0m19:25:34.593420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_listings)
[0m19:25:34.593766 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m19:25:34.600555 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m19:25:34.602015 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m19:25:34.626188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m19:25:34.627297 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m19:25:34.627534 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m19:25:34.909396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m19:25:34.933427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd65653a3-bf36-4a3e-ba6f-736ca31e507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10450a0c0>]}
[0m19:25:34.933917 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.34s]
[0m19:25:34.934318 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m19:25:34.935109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:25:34.935299 [debug] [MainThread]: Connection 'model.dbtlearn.src_listings' was left open.
[0m19:25:34.935473 [debug] [MainThread]: On model.dbtlearn.src_listings: Close
[0m19:25:35.045287 [info ] [MainThread]: 
[0m19:25:35.045797 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m19:25:35.046503 [debug] [MainThread]: Command end result
[0m19:25:35.063772 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:25:35.065142 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:25:35.069719 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m19:25:35.070029 [info ] [MainThread]: 
[0m19:25:35.070306 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:25:35.070494 [info ] [MainThread]: 
[0m19:25:35.070704 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:25:35.079515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2110894, "process_in_blocks": "0", "process_kernel_time": 0.245088, "process_mem_max_rss": "141328384", "process_out_blocks": "0", "process_user_time": 1.408065}
[0m19:25:35.079966 [debug] [MainThread]: Command `dbt run` succeeded at 19:25:35.079885 after 2.21 seconds
[0m19:25:35.080252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105200290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052026c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105200350>]}
[0m19:25:35.080515 [debug] [MainThread]: Flushing usage events
[0m19:25:35.257236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:32:27.316949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058786b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb41d0>]}


============================== 19:32:27.319747 | cfde6d56-935b-49bc-b377-36a88322b90d ==============================
[0m19:32:27.319747 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:32:27.320057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:32:27.520159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107235880>]}
[0m19:32:27.543733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efd550>]}
[0m19:32:27.544188 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:32:27.611798 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:32:27.657834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:32:27.658084 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_reviews.sql
[0m19:32:27.752843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e01640>]}
[0m19:32:27.775183 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:32:27.776770 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:32:27.787608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079200e0>]}
[0m19:32:27.787823 [info ] [MainThread]: Found 2 models, 472 macros
[0m19:32:27.787973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cdfa70>]}
[0m19:32:27.788707 [info ] [MainThread]: 
[0m19:32:27.788865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:32:27.788979 [info ] [MainThread]: 
[0m19:32:27.789172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:32:27.791277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:32:27.832896 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:32:27.833107 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:32:27.833248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:28.663682 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.830 seconds
[0m19:32:28.668186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:32:28.677217 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:32:28.677532 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m19:32:28.863685 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.186 seconds
[0m19:32:28.868049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069630e0>]}
[0m19:32:28.871475 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m19:32:28.871929 [info ] [Thread-1 (]: 1 of 2 START sql view model DEV.src_listings ................................... [RUN]
[0m19:32:28.872263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_listings)
[0m19:32:28.872739 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m19:32:28.877839 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m19:32:28.878570 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m19:32:28.903666 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m19:32:28.905068 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m19:32:28.905687 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m19:32:29.257847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.348 seconds
[0m19:32:29.285992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b1b80>]}
[0m19:32:29.286644 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.41s]
[0m19:32:29.287212 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m19:32:29.287563 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m19:32:29.287976 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.src_reviews .................................... [RUN]
[0m19:32:29.288330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m19:32:29.288576 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m19:32:29.290120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m19:32:29.290772 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m19:32:29.293033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m19:32:29.294258 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m19:32:29.294625 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m19:32:29.433716 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb7ee4-0002-a5a0-0000-0007b49662d5
[0m19:32:29.434011 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001100 (42601): SQL compilation error:
'RAW_REVIEWS' is an invalid Recursive CTE
[0m19:32:29.436679 [debug] [Thread-1 (]: Database Error in model src_reviews (models/src/src_reviews.sql)
  001100 (42601): SQL compilation error:
  'RAW_REVIEWS' is an invalid Recursive CTE
  compiled code at target/run/dbtlearn/models/src/src_reviews.sql
[0m19:32:29.436959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfde6d56-935b-49bc-b377-36a88322b90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f322720>]}
[0m19:32:29.437436 [error] [Thread-1 (]: 2 of 2 ERROR creating sql view model DEV.src_reviews ........................... [[31mERROR[0m in 0.15s]
[0m19:32:29.437753 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m19:32:29.438038 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.src_reviews' to be skipped because of status 'error'.  Reason: Database Error in model src_reviews (models/src/src_reviews.sql)
  001100 (42601): SQL compilation error:
  'RAW_REVIEWS' is an invalid Recursive CTE
  compiled code at target/run/dbtlearn/models/src/src_reviews.sql.
[0m19:32:29.438948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:29.439110 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was left open.
[0m19:32:29.439246 [debug] [MainThread]: On model.dbtlearn.src_reviews: Close
[0m19:32:29.511666 [info ] [MainThread]: 
[0m19:32:29.512131 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m19:32:29.512938 [debug] [MainThread]: Command end result
[0m19:32:29.534258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:32:29.535602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:32:29.539321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m19:32:29.539532 [info ] [MainThread]: 
[0m19:32:29.539763 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:32:29.539956 [info ] [MainThread]: 
[0m19:32:29.540185 [error] [MainThread]:   Database Error in model src_reviews (models/src/src_reviews.sql)
  001100 (42601): SQL compilation error:
  'RAW_REVIEWS' is an invalid Recursive CTE
  compiled code at target/run/dbtlearn/models/src/src_reviews.sql
[0m19:32:29.540367 [info ] [MainThread]: 
[0m19:32:29.540562 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m19:32:29.542597 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.257446, "process_in_blocks": "0", "process_kernel_time": 0.230758, "process_mem_max_rss": "141885440", "process_out_blocks": "0", "process_user_time": 1.145072}
[0m19:32:29.543013 [debug] [MainThread]: Command `dbt run` failed at 19:32:29.542937 after 2.26 seconds
[0m19:32:29.543344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060e3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb4260>]}
[0m19:32:29.543668 [debug] [MainThread]: Flushing usage events
[0m19:32:29.845288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:33:15.094458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016f7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0be60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d3c170>]}


============================== 19:33:15.097243 | 0e82ebd7-ee2f-48e4-8352-8b929990a6c9 ==============================
[0m19:33:15.097243 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:33:15.097598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:33:15.277720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050375c0>]}
[0m19:33:15.301438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105133a70>]}
[0m19:33:15.302024 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:33:15.367360 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:33:15.409981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:33:15.410248 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_reviews.sql
[0m19:33:15.503461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a78710>]}
[0m19:33:15.526388 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:33:15.527918 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:33:15.536936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057dbcb0>]}
[0m19:33:15.537152 [info ] [MainThread]: Found 2 models, 472 macros
[0m19:33:15.537304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582a300>]}
[0m19:33:15.538040 [info ] [MainThread]: 
[0m19:33:15.538200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:33:15.538317 [info ] [MainThread]: 
[0m19:33:15.538506 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:33:15.540403 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:33:15.568783 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:33:15.568970 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:33:15.569102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:33:16.115878 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.546 seconds
[0m19:33:16.121664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:33:16.137401 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:33:16.137695 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m19:33:16.262237 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.124 seconds
[0m19:33:16.264393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059adc10>]}
[0m19:33:16.266705 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m19:33:16.267099 [info ] [Thread-1 (]: 1 of 2 START sql view model DEV.src_listings ................................... [RUN]
[0m19:33:16.267423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_listings)
[0m19:33:16.267876 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m19:33:16.273018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m19:33:16.273778 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m19:33:16.293204 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m19:33:16.294048 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m19:33:16.294263 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m19:33:16.600732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.306 seconds
[0m19:33:16.629125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028c7fb0>]}
[0m19:33:16.629811 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.36s]
[0m19:33:16.630272 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m19:33:16.630563 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m19:33:16.630975 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.src_reviews .................................... [RUN]
[0m19:33:16.631357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m19:33:16.631595 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m19:33:16.633137 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m19:33:16.633803 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m19:33:16.635697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m19:33:16.637084 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m19:33:16.637427 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m19:33:16.934406 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.296 seconds
[0m19:33:16.938607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e82ebd7-ee2f-48e4-8352-8b929990a6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0860>]}
[0m19:33:16.939832 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.31s]
[0m19:33:16.940843 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m19:33:16.942505 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:33:16.942954 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was left open.
[0m19:33:16.943312 [debug] [MainThread]: On model.dbtlearn.src_reviews: Close
[0m19:33:17.089725 [info ] [MainThread]: 
[0m19:33:17.090897 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m19:33:17.092422 [debug] [MainThread]: Command end result
[0m19:33:17.116291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:33:17.117704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:33:17.121763 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m19:33:17.121981 [info ] [MainThread]: 
[0m19:33:17.122218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:33:17.122400 [info ] [MainThread]: 
[0m19:33:17.122597 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:33:17.124719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.061984, "process_in_blocks": "0", "process_kernel_time": 0.220072, "process_mem_max_rss": "142983168", "process_out_blocks": "0", "process_user_time": 1.126835}
[0m19:33:17.125066 [debug] [MainThread]: Command `dbt run` succeeded at 19:33:17.124998 after 2.06 seconds
[0m19:33:17.125326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104850fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a2810>]}
[0m19:33:17.125593 [debug] [MainThread]: Flushing usage events
[0m19:33:17.183555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:50.903397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088805c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088802c0>]}


============================== 19:40:50.906471 | 87a12ce2-85c6-40a0-81b6-f8d2cf392ea8 ==============================
[0m19:40:50.906471 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:40:50.906764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:40:51.097833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106425010>]}
[0m19:40:51.121004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c2a180>]}
[0m19:40:51.121542 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m19:40:51.187221 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:40:51.233398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:40:51.233642 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/src/src_hosts.sql
[0m19:40:51.329070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c0b00>]}
[0m19:40:51.352709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:40:51.354514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:40:51.365414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093265a0>]}
[0m19:40:51.365642 [info ] [MainThread]: Found 3 models, 472 macros
[0m19:40:51.365808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094bcf20>]}
[0m19:40:51.366592 [info ] [MainThread]: 
[0m19:40:51.366747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:51.366860 [info ] [MainThread]: 
[0m19:40:51.367065 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:51.369464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:40:51.399045 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:40:51.399228 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:40:51.399359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:51.995210 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.596 seconds
[0m19:40:51.999091 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:40:52.009865 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:40:52.010227 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m19:40:52.115727 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.105 seconds
[0m19:40:52.119788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109288710>]}
[0m19:40:52.125409 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m19:40:52.126120 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m19:40:52.126987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m19:40:52.127343 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m19:40:52.134318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m19:40:52.135521 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m19:40:52.158786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m19:40:52.160376 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m19:40:52.160658 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m19:40:52.439560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.278 seconds
[0m19:40:52.467414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f7ec0>]}
[0m19:40:52.468181 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.34s]
[0m19:40:52.468662 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m19:40:52.468978 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m19:40:52.469430 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listings ................................... [RUN]
[0m19:40:52.469861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m19:40:52.470140 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m19:40:52.471855 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m19:40:52.472693 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m19:40:52.474600 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m19:40:52.475620 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m19:40:52.475972 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m19:40:52.852145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.376 seconds
[0m19:40:52.860791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099eae70>]}
[0m19:40:52.861835 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.39s]
[0m19:40:52.862572 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m19:40:52.863036 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m19:40:52.863713 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.src_reviews .................................... [RUN]
[0m19:40:52.864329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m19:40:52.864691 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m19:40:52.866799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m19:40:52.868845 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m19:40:52.873650 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m19:40:52.875162 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m19:40:52.875491 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m19:40:53.145349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m19:40:53.150005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87a12ce2-85c6-40a0-81b6-f8d2cf392ea8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a69550>]}
[0m19:40:53.150693 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.29s]
[0m19:40:53.151327 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m19:40:53.152466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:53.152775 [debug] [MainThread]: Connection 'model.dbtlearn.src_reviews' was left open.
[0m19:40:53.152984 [debug] [MainThread]: On model.dbtlearn.src_reviews: Close
[0m19:40:53.231929 [info ] [MainThread]: 
[0m19:40:53.232388 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m19:40:53.233169 [debug] [MainThread]: Command end result
[0m19:40:53.247685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m19:40:53.248902 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m19:40:53.252195 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m19:40:53.252371 [info ] [MainThread]: 
[0m19:40:53.252570 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:53.252726 [info ] [MainThread]: 
[0m19:40:53.252884 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:40:53.254565 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.383349, "process_in_blocks": "0", "process_kernel_time": 0.234813, "process_mem_max_rss": "142983168", "process_out_blocks": "0", "process_user_time": 1.166987}
[0m19:40:53.254810 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:53.254759 after 2.38 seconds
[0m19:40:53.255005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afabd0>]}
[0m19:40:53.255203 [debug] [MainThread]: Flushing usage events
[0m19:40:53.390205 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:01.581240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c3e0>]}


============================== 16:12:01.584464 | 0a9cc9f0-bc45-408a-a788-9ed6875b2d58 ==============================
[0m16:12:01.584464 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:12:01.584836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:01.796280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093bf170>]}
[0m16:12:01.822270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b51c0>]}
[0m16:12:01.822900 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:12:01.892951 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:12:01.939897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:12:01.940161 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_cleansed.sql
[0m16:12:02.041266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109813aa0>]}
[0m16:12:02.065194 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:12:02.067052 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:12:02.078530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b64830>]}
[0m16:12:02.078767 [info ] [MainThread]: Found 4 models, 472 macros
[0m16:12:02.078929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb73b0>]}
[0m16:12:02.079833 [info ] [MainThread]: 
[0m16:12:02.080019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:02.080146 [info ] [MainThread]: 
[0m16:12:02.080359 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:02.082427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:12:02.122285 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:12:02.122505 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:12:02.122642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:02.780861 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.658 seconds
[0m16:12:02.785275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:12:02.797378 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:12:02.797783 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:12:02.991872 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.194 seconds
[0m16:12:02.994412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750a780>]}
[0m16:12:02.998252 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:12:02.998712 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:12:02.999371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:12:02.999611 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:12:03.004398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:12:03.005511 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:12:03.024491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:12:03.025712 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:12:03.025944 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:12:03.423089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.397 seconds
[0m16:12:03.448656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ec5d90>]}
[0m16:12:03.449237 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.45s]
[0m16:12:03.449693 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:12:03.449981 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:12:03.450391 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listings ................................... [RUN]
[0m16:12:03.450800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:12:03.451056 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:12:03.452435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:12:03.453417 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:12:03.456647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:12:03.458241 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:12:03.458600 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:12:03.915316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.456 seconds
[0m16:12:03.919212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae808c0>]}
[0m16:12:03.920086 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.47s]
[0m16:12:03.920781 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:12:03.921241 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:12:03.921940 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:12:03.922805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:12:03.923454 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:12:03.925973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:12:03.927830 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:12:03.931023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:12:03.932650 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:12:03.933079 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:12:04.143663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m16:12:04.149724 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae80110>]}
[0m16:12:04.150914 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.23s]
[0m16:12:04.151712 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:12:04.152161 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:12:04.152693 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m16:12:04.153258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_listings_cleansed)
[0m16:12:04.153669 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:12:04.156862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:12:04.157888 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:12:04.160943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:12:04.162371 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:12:04.162802 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
  );
[0m16:12:04.488250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m16:12:04.492397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9cc9f0-bc45-408a-a788-9ed6875b2d58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae29ee0>]}
[0m16:12:04.493280 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.34s]
[0m16:12:04.493905 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:12:04.495953 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:04.496567 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was left open.
[0m16:12:04.496942 [debug] [MainThread]: On model.dbtlearn.dim_listings_cleansed: Close
[0m16:12:04.585877 [info ] [MainThread]: 
[0m16:12:04.586679 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m16:12:04.588057 [debug] [MainThread]: Command end result
[0m16:12:04.610541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:12:04.612445 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:12:04.618508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:12:04.618774 [info ] [MainThread]: 
[0m16:12:04.619052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:04.619250 [info ] [MainThread]: 
[0m16:12:04.619469 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:12:04.627555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0818653, "process_in_blocks": "0", "process_kernel_time": 0.259695, "process_mem_max_rss": "141967360", "process_out_blocks": "0", "process_user_time": 1.225368}
[0m16:12:04.627957 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:04.627882 after 3.08 seconds
[0m16:12:04.628256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ecde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca0aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aea32c0>]}
[0m16:12:04.628790 [debug] [MainThread]: Flushing usage events
[0m16:12:04.729904 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:09.477741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a69a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f8ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbc7a0>]}


============================== 16:20:09.481436 | ad181f88-0d64-45ac-8dfa-0f83992dfb7a ==============================
[0m16:20:09.481436 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:20:09.481743 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:09.674537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767bbf0>]}
[0m16:20:09.698139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cda00>]}
[0m16:20:09.698685 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:20:09.764568 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:20:09.811305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:20:09.811549 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_hosts_cleansed.sql
[0m16:20:09.907760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d01a60>]}
[0m16:20:09.930931 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:20:09.932809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:20:09.943772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cbc650>]}
[0m16:20:09.943993 [info ] [MainThread]: Found 5 models, 472 macros
[0m16:20:09.944157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfdd00>]}
[0m16:20:09.944980 [info ] [MainThread]: 
[0m16:20:09.945139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:09.945261 [info ] [MainThread]: 
[0m16:20:09.945456 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:09.947516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:20:09.987381 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:20:09.987590 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:20:09.987733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:10.559562 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.572 seconds
[0m16:20:10.564232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:20:10.576628 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:20:10.577072 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:20:10.670891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.093 seconds
[0m16:20:10.675747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f35640>]}
[0m16:20:10.680796 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:20:10.681600 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:20:10.682182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:20:10.682570 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:20:10.689755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:20:10.691059 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:20:10.715137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:20:10.716355 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:20:10.716610 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:20:10.977983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.261 seconds
[0m16:20:11.006352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ca1e0>]}
[0m16:20:11.006899 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.32s]
[0m16:20:11.007340 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:20:11.007618 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:20:11.008055 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m16:20:11.008464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:20:11.008774 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:20:11.010135 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:20:11.010682 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:20:11.013909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:20:11.015144 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:20:11.015435 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:20:11.501963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.486 seconds
[0m16:20:11.506005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081437a0>]}
[0m16:20:11.506837 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.50s]
[0m16:20:11.507818 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:20:11.508498 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:20:11.509231 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:20:11.510082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:20:11.510567 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:20:11.512875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:20:11.514164 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:20:11.517377 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:20:11.518648 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:20:11.519016 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:20:11.868119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m16:20:11.870843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108143fb0>]}
[0m16:20:11.871491 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.36s]
[0m16:20:11.872045 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:20:11.872409 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m16:20:11.872877 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m16:20:11.873340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m16:20:11.873648 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m16:20:11.876603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:20:11.877572 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m16:20:11.880339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:20:11.881237 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:20:11.881516 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
  );
[0m16:20:12.144936 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.263 seconds
[0m16:20:12.149086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819a180>]}
[0m16:20:12.150262 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.28s]
[0m16:20:12.151108 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m16:20:12.152098 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:20:12.152805 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m16:20:12.153469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m16:20:12.153908 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:20:12.157108 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:20:12.158646 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:20:12.161681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:20:12.162906 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:20:12.163240 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
  );
[0m16:20:12.547614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m16:20:12.551998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad181f88-0d64-45ac-8dfa-0f83992dfb7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818e6f0>]}
[0m16:20:12.552903 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.40s]
[0m16:20:12.553517 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:20:12.554841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:12.555147 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was left open.
[0m16:20:12.555431 [debug] [MainThread]: On model.dbtlearn.dim_listings_cleansed: Close
[0m16:20:12.640503 [info ] [MainThread]: 
[0m16:20:12.641135 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 2.69 seconds (2.69s).
[0m16:20:12.642351 [debug] [MainThread]: Command end result
[0m16:20:12.664474 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:20:12.665790 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:20:12.670187 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:20:12.670438 [info ] [MainThread]: 
[0m16:20:12.670688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:12.670876 [info ] [MainThread]: 
[0m16:20:12.671076 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:20:12.673556 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.2270923, "process_in_blocks": "0", "process_kernel_time": 0.229127, "process_mem_max_rss": "142524416", "process_out_blocks": "0", "process_user_time": 1.213556}
[0m16:20:12.673848 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:12.673790 after 3.23 seconds
[0m16:20:12.674086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbc860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a69a60>]}
[0m16:20:12.674313 [debug] [MainThread]: Flushing usage events
[0m16:20:12.787830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:23.839753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edfcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107438680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074383e0>]}


============================== 16:24:23.842495 | e5158776-cceb-4822-aa58-6952fdc49184 ==============================
[0m16:24:23.842495 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:24:23.842788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'profiles_dir': '/Users/amanarya/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:24:24.029083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dd6a0>]}
[0m16:24:24.052549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aef140>]}
[0m16:24:24.053095 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:24:24.116659 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:24:24.144557 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:24:24.144801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f45f70>]}
[0m16:24:24.565169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108070260>]}
[0m16:24:24.587547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:24:24.589150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:24:24.600075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e56a0>]}
[0m16:24:24.600282 [info ] [MainThread]: Found 5 models, 472 macros
[0m16:24:24.600440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8ad20>]}
[0m16:24:24.601223 [info ] [MainThread]: 
[0m16:24:24.601383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:24.601500 [info ] [MainThread]: 
[0m16:24:24.601700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:24.603775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:24:24.643035 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:24:24.643239 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:24:24.643374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:25.076936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.433 seconds
[0m16:24:25.080088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:24:25.089898 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:24:25.090194 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:24:25.224135 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.134 seconds
[0m16:24:25.228984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba7920>]}
[0m16:24:25.231150 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:24:25.231392 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:24:25.231599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:24:25.231750 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:24:25.234862 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:24:25.235416 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:24:25.257381 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:24:25.258508 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:24:25.258772 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:24:25.516271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m16:24:25.543917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb80e0>]}
[0m16:24:25.544530 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.31s]
[0m16:24:25.544979 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:24:25.545275 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:24:25.545753 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listings ................................... [RUN]
[0m16:24:25.546197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:24:25.546441 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:24:25.547889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:24:25.548717 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:24:25.550707 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:24:25.551873 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:24:25.552251 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:24:26.058448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m16:24:26.064371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a1d00>]}
[0m16:24:26.065188 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.52s]
[0m16:24:26.065729 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:24:26.066080 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:24:26.066731 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:24:26.067572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:24:26.068089 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:24:26.070419 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:24:26.071228 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:24:26.074360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:24:26.075818 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:24:26.076243 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:24:26.281024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m16:24:26.285868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108599790>]}
[0m16:24:26.286886 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.22s]
[0m16:24:26.287724 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:24:26.288331 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m16:24:26.288750 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m16:24:26.289129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m16:24:26.289405 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m16:24:26.292293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:24:26.294300 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m16:24:26.303077 [debug] [Thread-1 (]:  adapter: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is a view and target relation AIRBNB.DEV.dim_hosts_cleansed is of type table.
[0m16:24:26.309760 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m16:24:26.314800 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:24:26.315089 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m16:24:26.444139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:24:26.461037 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:24:26.463566 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:24:26.463956 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m16:24:27.099071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m16:24:27.101461 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa7200>]}
[0m16:24:27.102244 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m16:24:27.102916 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m16:24:27.103282 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:24:27.103796 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m16:24:27.104285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m16:24:27.104589 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:24:27.107397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:24:27.108412 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:24:27.112553 [debug] [Thread-1 (]:  adapter: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is a view and target relation AIRBNB.DEV.dim_listings_cleansed is of type table.
[0m16:24:27.114633 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m16:24:27.115308 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:24:27.115590 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m16:24:27.287960 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m16:24:27.289512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:24:27.291744 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:24:27.292095 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m16:24:28.282923 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m16:24:28.286096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5158776-cceb-4822-aa58-6952fdc49184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086a34d0>]}
[0m16:24:28.286779 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.18s]
[0m16:24:28.287389 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:24:28.288285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:28.288506 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_cleansed' was left open.
[0m16:24:28.288648 [debug] [MainThread]: On model.dbtlearn.dim_listings_cleansed: Close
[0m16:24:28.362267 [info ] [MainThread]: 
[0m16:24:28.363073 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m16:24:28.364164 [debug] [MainThread]: Command end result
[0m16:24:28.386279 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:24:28.387983 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:24:28.398077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:24:28.398302 [info ] [MainThread]: 
[0m16:24:28.398546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:28.398728 [info ] [MainThread]: 
[0m16:24:28.398929 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:24:28.401836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5952787, "process_in_blocks": "0", "process_kernel_time": 0.229746, "process_mem_max_rss": "142557184", "process_out_blocks": "0", "process_user_time": 1.51383}
[0m16:24:28.402119 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:28.402062 after 4.60 seconds
[0m16:24:28.402378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106764bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be0c0>]}
[0m16:24:28.402615 [debug] [MainThread]: Flushing usage events
[0m16:24:28.512150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:26.154701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112115e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272c350>]}


============================== 16:45:26.159392 | a23404ab-dc8b-4446-a769-98c415ffa22c ==============================
[0m16:45:26.159392 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:45:26.159748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:45:26.366131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a23404ab-dc8b-4446-a769-98c415ffa22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562d070>]}
[0m16:45:26.391101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a23404ab-dc8b-4446-a769-98c415ffa22c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141b36b0>]}
[0m16:45:26.391856 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:45:26.456849 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:45:26.505460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:45:26.505793 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fct_reviews.sql
[0m16:45:26.586919 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m16:45:26.589228 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.47009045, "process_in_blocks": "0", "process_kernel_time": 0.188841, "process_mem_max_rss": "125435904", "process_out_blocks": "0", "process_user_time": 0.915895}
[0m16:45:26.589468 [debug] [MainThread]: Command `dbt run` failed at 16:45:26.589419 after 0.47 seconds
[0m16:45:26.589660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105927890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140ad370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114256540>]}
[0m16:45:26.589828 [debug] [MainThread]: Flushing usage events
[0m16:45:26.684140 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:43.077670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e286e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e28440>]}


============================== 16:46:43.080063 | 0412e623-fa79-4066-9ef7-d0c9ed4d2f80 ==============================
[0m16:46:43.080063 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:46:43.080389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:46:43.216682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0412e623-fa79-4066-9ef7-d0c9ed4d2f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115742c0>]}
[0m16:46:43.241129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0412e623-fa79-4066-9ef7-d0c9ed4d2f80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a3680>]}
[0m16:46:43.241625 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:46:43.302617 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:46:43.341944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:46:43.342282 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fct_reviews.sql
[0m16:46:43.420446 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m16:46:43.421904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.37316653, "process_in_blocks": "0", "process_kernel_time": 0.150189, "process_mem_max_rss": "127516672", "process_out_blocks": "0", "process_user_time": 0.877876}
[0m16:46:43.422165 [debug] [MainThread]: Command `dbt run` failed at 16:46:43.422109 after 0.37 seconds
[0m16:46:43.422380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e28560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112824800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112824aa0>]}
[0m16:46:43.422562 [debug] [MainThread]: Flushing usage events
[0m16:46:43.495119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:47:25.921485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106718b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460290>]}


============================== 16:47:25.924132 | 3e50609c-1294-47a6-b751-22936060de3e ==============================
[0m16:47:25.924132 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:47:25.924471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:47:26.060187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ac8f0>]}
[0m16:47:26.083614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673f710>]}
[0m16:47:26.083979 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:47:26.144019 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:47:26.182769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:47:26.183014 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/fct/fct_reviews.sql
[0m16:47:26.284330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108152510>]}
[0m16:47:26.308115 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:47:26.310240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:47:26.321680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f09fd0>]}
[0m16:47:26.321882 [info ] [MainThread]: Found 6 models, 472 macros
[0m16:47:26.322046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811b380>]}
[0m16:47:26.322906 [info ] [MainThread]: 
[0m16:47:26.323075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:47:26.323192 [info ] [MainThread]: 
[0m16:47:26.323394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:47:26.325475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:47:26.365441 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:47:26.365667 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:47:26.365799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:26.963311 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.597 seconds
[0m16:47:26.967131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:47:26.979021 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:47:26.979432 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:47:27.076190 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.096 seconds
[0m16:47:27.080819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811b3e0>]}
[0m16:47:27.085459 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:47:27.086105 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:47:27.086572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:47:27.086908 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:47:27.090905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:47:27.091473 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:47:27.104361 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:47:27.105952 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:47:27.106114 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:47:27.377633 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m16:47:27.404173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108064470>]}
[0m16:47:27.404695 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.32s]
[0m16:47:27.405118 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:47:27.405389 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:47:27.405748 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m16:47:27.406085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:47:27.406312 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:47:27.407641 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:47:27.408531 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:47:27.410750 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:47:27.412173 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:47:27.412523 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:47:27.798887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.386 seconds
[0m16:47:27.803153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10879fa40>]}
[0m16:47:27.804266 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.40s]
[0m16:47:27.805182 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:47:27.805662 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:47:27.806321 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:47:27.807062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:47:27.807472 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:47:27.809692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:47:27.811281 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:47:27.814461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:47:27.815948 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:47:27.816365 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:47:28.199189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m16:47:28.204317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086ee3c0>]}
[0m16:47:28.205293 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.40s]
[0m16:47:28.206016 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:47:28.206394 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m16:47:28.206968 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m16:47:28.207567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m16:47:28.207963 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m16:47:28.210604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:47:28.212462 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m16:47:28.223572 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:47:28.224563 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:47:28.224749 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m16:47:29.658853 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.433 seconds
[0m16:47:29.664857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109533b60>]}
[0m16:47:29.665837 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.46s]
[0m16:47:29.666509 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m16:47:29.666950 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:47:29.667798 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m16:47:29.668687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m16:47:29.669140 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:47:29.672796 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:47:29.674612 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:47:29.675887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:47:29.677170 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:47:29.677344 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m16:47:31.000829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.323 seconds
[0m16:47:31.005013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109533830>]}
[0m16:47:31.005966 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.34s]
[0m16:47:31.006635 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:47:31.007083 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m16:47:31.007755 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:47:31.008674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m16:47:31.009063 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m16:47:31.013097 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m16:47:31.014239 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m16:47:31.043731 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m16:47:31.044649 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:47:31.044882 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

        );
[0m16:47:33.294245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.249 seconds
[0m16:47:33.304588 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:47:33.312423 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:47:33.312817 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:47:33.388238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m16:47:33.391968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e50609c-1294-47a6-b751-22936060de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e3260>]}
[0m16:47:33.392890 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.38s]
[0m16:47:33.393531 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m16:47:33.395055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:33.395281 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was left open.
[0m16:47:33.395412 [debug] [MainThread]: On model.dbtlearn.fct_reviews: Close
[0m16:47:33.474542 [info ] [MainThread]: 
[0m16:47:33.475244 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m16:47:33.477126 [debug] [MainThread]: Command end result
[0m16:47:33.499779 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:47:33.501590 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:47:33.506799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:47:33.507107 [info ] [MainThread]: 
[0m16:47:33.507448 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:47:33.507649 [info ] [MainThread]: 
[0m16:47:33.507875 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:47:33.510719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.619217, "process_in_blocks": "0", "process_kernel_time": 0.260632, "process_mem_max_rss": "146128896", "process_out_blocks": "0", "process_user_time": 1.38203}
[0m16:47:33.511016 [debug] [MainThread]: Command `dbt run` succeeded at 16:47:33.510958 after 7.62 seconds
[0m16:47:33.511267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c875f0>]}
[0m16:47:33.511509 [debug] [MainThread]: Flushing usage events
[0m16:47:33.609344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:57.468075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066038f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b58290>]}


============================== 16:54:57.471992 | d897d390-9791-468a-93a8-4e780d88a243 ==============================
[0m16:54:57.471992 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:54:57.472314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:54:57.653441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c9400>]}
[0m16:54:57.676947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3770>]}
[0m16:54:57.677478 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:54:57.742228 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:54:57.789311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:57.789507 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:57.800671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743d430>]}
[0m16:54:57.825295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:54:57.827042 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:54:57.837844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f5880>]}
[0m16:54:57.838058 [info ] [MainThread]: Found 6 models, 472 macros
[0m16:54:57.838218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761a780>]}
[0m16:54:57.839039 [info ] [MainThread]: 
[0m16:54:57.839221 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:54:57.839342 [info ] [MainThread]: 
[0m16:54:57.839547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:54:57.841607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:54:57.882735 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:54:57.882978 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:54:57.883136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:58.300245 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.417 seconds
[0m16:54:58.304544 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:54:58.318505 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:54:58.318963 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:54:58.421470 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m16:54:58.424648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071965a0>]}
[0m16:54:58.427637 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:54:58.428101 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:54:58.428488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:54:58.428767 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:54:58.437305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:54:58.438573 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:54:58.458505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:54:58.459374 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:54:58.459553 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:54:58.803836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m16:54:58.830522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e61d60>]}
[0m16:54:58.831136 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.40s]
[0m16:54:58.831609 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:54:58.831954 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:54:58.832401 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m16:54:58.832850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:54:58.833099 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:54:58.834585 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:54:58.835463 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:54:58.837444 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:54:58.838473 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:54:58.838766 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:54:59.367234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m16:54:59.371236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bfb560>]}
[0m16:54:59.371870 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.54s]
[0m16:54:59.372394 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:54:59.372759 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:54:59.373281 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:54:59.373776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:54:59.374210 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:54:59.376274 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:54:59.378036 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:54:59.380724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:54:59.382528 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:54:59.382941 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:54:59.765039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m16:54:59.770426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c01e80>]}
[0m16:54:59.771078 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.40s]
[0m16:54:59.771375 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:54:59.771552 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m16:54:59.771769 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m16:54:59.771992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m16:54:59.772139 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m16:54:59.773577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:54:59.774402 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m16:54:59.793547 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:54:59.794519 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:54:59.794735 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m16:55:00.408763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m16:55:00.412968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cda6f0>]}
[0m16:55:00.413821 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:55:00.414726 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m16:55:00.415305 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:55:00.415958 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m16:55:00.416509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m16:55:00.416844 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:55:00.451200 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:55:00.452211 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:55:00.454310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:55:00.455610 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:55:00.455908 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m16:55:01.638669 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.182 seconds
[0m16:55:01.642754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b00740>]}
[0m16:55:01.643561 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.23s]
[0m16:55:01.644122 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:55:01.644478 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m16:55:01.644925 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:55:01.645321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m16:55:01.645613 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m16:55:01.653675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m16:55:01.655790 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m16:55:01.681559 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:01.681849 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m16:55:02.215932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m16:55:02.220365 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:02.220554 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:55:02.326840 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.106 seconds
[0m16:55:02.330567 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:02.330993 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m16:55:02.447441 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.116 seconds
[0m16:55:02.461783 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:02.462162 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:55:02.553353 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.090 seconds
[0m16:55:02.559245 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:02.559797 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:55:02.625533 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m16:55:02.634640 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:55:02.643478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m16:55:02.645349 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:02.645624 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:55:02.832720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m16:55:02.834419 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:02.835195 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m16:55:03.047717 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.212 seconds
[0m16:55:03.048952 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:03.049475 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m16:55:03.179648 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.129 seconds
[0m16:55:03.194336 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:55:03.201442 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:55:03.201819 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:55:03.301536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m16:55:03.304911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd897d390-9791-468a-93a8-4e780d88a243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072fac00>]}
[0m16:55:03.305757 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.66s]
[0m16:55:03.306425 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m16:55:03.307836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:03.308296 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was left open.
[0m16:55:03.308647 [debug] [MainThread]: On model.dbtlearn.fct_reviews: Close
[0m16:55:03.428232 [info ] [MainThread]: 
[0m16:55:03.429171 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 5.59 seconds (5.59s).
[0m16:55:03.431037 [debug] [MainThread]: Command end result
[0m16:55:03.455434 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:55:03.459178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:55:03.464590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:55:03.464856 [info ] [MainThread]: 
[0m16:55:03.465146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:03.465364 [info ] [MainThread]: 
[0m16:55:03.465605 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:55:03.468738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.03263, "process_in_blocks": "0", "process_kernel_time": 0.227332, "process_mem_max_rss": "140607488", "process_out_blocks": "0", "process_user_time": 1.289318}
[0m16:55:03.469047 [debug] [MainThread]: Command `dbt run` succeeded at 16:55:03.468982 after 6.03 seconds
[0m16:55:03.469327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10649dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b59af0>]}
[0m16:55:03.469579 [debug] [MainThread]: Flushing usage events
[0m16:55:03.574759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:29.011830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb79b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107514170>]}


============================== 16:57:29.014430 | 1f684699-889f-45e3-bed4-98988af45686 ==============================
[0m16:57:29.014430 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:57:29.014735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:29.149325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c9040>]}
[0m16:57:29.172534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058b11c0>]}
[0m16:57:29.172913 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:57:29.233614 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:57:29.272936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:29.273182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:29.284951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775fb00>]}
[0m16:57:29.309532 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:57:29.311068 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:57:29.317236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fad610>]}
[0m16:57:29.317451 [info ] [MainThread]: Found 6 models, 472 macros
[0m16:57:29.317598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbee10>]}
[0m16:57:29.318361 [info ] [MainThread]: 
[0m16:57:29.318512 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:29.318627 [info ] [MainThread]: 
[0m16:57:29.318829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:57:29.321120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:57:29.348108 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:57:29.348341 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:57:29.348483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:29.812704 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.464 seconds
[0m16:57:29.817824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:57:29.829199 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:57:29.829523 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:57:29.934609 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.105 seconds
[0m16:57:29.938432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f64920>]}
[0m16:57:29.940776 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:57:29.941549 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:57:29.942128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:57:29.942539 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:57:29.951214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:57:29.952191 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:57:29.975216 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:57:29.976244 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:57:29.976487 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:57:30.271407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m16:57:30.298519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106819b80>]}
[0m16:57:30.299059 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.36s]
[0m16:57:30.299735 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:57:30.300320 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:57:30.300791 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m16:57:30.301122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:57:30.301357 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:57:30.302671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:57:30.303259 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:57:30.305352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:57:30.306619 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:57:30.307207 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:57:30.629375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.321 seconds
[0m16:57:30.634286 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858b590>]}
[0m16:57:30.635200 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.33s]
[0m16:57:30.635764 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:57:30.636136 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:57:30.636696 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:57:30.637246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:57:30.637672 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:57:30.639623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:57:30.640527 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:57:30.643276 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:57:30.644562 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:57:30.644877 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:57:30.925363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m16:57:30.928789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850f9e0>]}
[0m16:57:30.929790 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.29s]
[0m16:57:30.930634 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:57:30.931094 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m16:57:30.931443 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m16:57:30.931693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m16:57:30.931892 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m16:57:30.933250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:57:30.933710 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m16:57:30.948438 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:57:30.949536 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:57:30.949778 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m16:57:31.551649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m16:57:31.555672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108693dd0>]}
[0m16:57:31.556656 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:57:31.557257 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m16:57:31.557629 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:57:31.558143 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m16:57:31.558677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m16:57:31.559031 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:57:31.595272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:57:31.595924 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:57:31.597230 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:57:31.597898 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:57:31.598080 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m16:57:32.257552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m16:57:32.261661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108691c10>]}
[0m16:57:32.262508 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:57:32.263202 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:57:32.263870 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m16:57:32.264809 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:57:32.265505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m16:57:32.265935 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m16:57:32.274986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m16:57:32.275690 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m16:57:32.293821 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:32.294121 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m16:57:32.554731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.260 seconds
[0m16:57:32.567158 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:32.567700 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:57:32.677467 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.109 seconds
[0m16:57:32.683318 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:32.683907 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m16:57:32.743996 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.059 seconds
[0m16:57:32.761100 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:32.761551 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:57:32.832591 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.071 seconds
[0m16:57:32.836486 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:32.836870 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:57:32.951572 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.114 seconds
[0m16:57:32.964851 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:57:32.980363 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m16:57:32.981480 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:32.981762 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:57:33.116155 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m16:57:33.117054 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:33.117599 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m16:57:33.536534 [debug] [Thread-1 (]: SQL status: SUCCESS 4 in 0.418 seconds
[0m16:57:33.537821 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:33.538294 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m16:57:33.817313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m16:57:33.827757 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:57:33.834087 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:57:33.834248 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:57:33.977524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.143 seconds
[0m16:57:33.981860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f684699-889f-45e3-bed4-98988af45686', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081456a0>]}
[0m16:57:33.982802 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 4[0m in 1.72s]
[0m16:57:33.984117 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m16:57:33.985880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:33.986384 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was left open.
[0m16:57:33.986767 [debug] [MainThread]: On model.dbtlearn.fct_reviews: Close
[0m16:57:34.079041 [info ] [MainThread]: 
[0m16:57:34.079309 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 4.76 seconds (4.76s).
[0m16:57:34.079889 [debug] [MainThread]: Command end result
[0m16:57:34.093973 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:57:34.095199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:57:34.099134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:57:34.099373 [info ] [MainThread]: 
[0m16:57:34.099574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:57:34.099731 [info ] [MainThread]: 
[0m16:57:34.099900 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:57:34.101511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.118924, "process_in_blocks": "0", "process_kernel_time": 0.205741, "process_mem_max_rss": "144113664", "process_out_blocks": "0", "process_user_time": 1.290767}
[0m16:57:34.101850 [debug] [MainThread]: Command `dbt run` succeeded at 16:57:34.101790 after 5.12 seconds
[0m16:57:34.102072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d29b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d28800>]}
[0m16:57:34.102277 [debug] [MainThread]: Flushing usage events
[0m16:57:34.200301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:11.770184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc45f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc4350>]}


============================== 16:59:11.773016 | bb44e91b-0c11-43cc-a62e-80d204a7ad82 ==============================
[0m16:59:11.773016 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:59:11.773382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --full-refresh', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:11.910091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10958f470>]}
[0m16:59:11.933802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981a2d0>]}
[0m16:59:11.934181 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:59:11.995726 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:59:12.034238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:12.034430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:12.045650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098affb0>]}
[0m16:59:12.069929 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:59:12.071412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:59:12.077465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a41fd0>]}
[0m16:59:12.077664 [info ] [MainThread]: Found 6 models, 472 macros
[0m16:59:12.077819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a8b890>]}
[0m16:59:12.078653 [info ] [MainThread]: 
[0m16:59:12.078812 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:59:12.078954 [info ] [MainThread]: 
[0m16:59:12.079188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:59:12.081348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:59:12.108617 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:59:12.108852 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:59:12.108995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:12.522227 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.413 seconds
[0m16:59:12.526749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:59:12.533739 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:59:12.533895 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m16:59:12.688852 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.155 seconds
[0m16:59:12.692731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2e990>]}
[0m16:59:12.695375 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m16:59:12.696302 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m16:59:12.696883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m16:59:12.697289 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m16:59:12.705955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m16:59:12.706740 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m16:59:12.730239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m16:59:12.731258 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m16:59:12.731502 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m16:59:13.171233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m16:59:13.185700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b80050>]}
[0m16:59:13.186010 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.49s]
[0m16:59:13.186289 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m16:59:13.186453 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m16:59:13.186675 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listings ................................... [RUN]
[0m16:59:13.186890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m16:59:13.187031 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m16:59:13.187798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m16:59:13.188190 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m16:59:13.189629 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m16:59:13.190171 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m16:59:13.190342 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m16:59:13.474638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m16:59:13.479437 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a273770>]}
[0m16:59:13.480500 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.29s]
[0m16:59:13.481263 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m16:59:13.481783 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m16:59:13.482466 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m16:59:13.483671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m16:59:13.484157 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m16:59:13.487065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m16:59:13.488255 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m16:59:13.491238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m16:59:13.492303 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m16:59:13.492611 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m16:59:13.927675 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.435 seconds
[0m16:59:13.930242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bfdeb0>]}
[0m16:59:13.930885 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.45s]
[0m16:59:13.931472 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m16:59:13.931835 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m16:59:13.932398 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m16:59:13.933041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m16:59:13.933395 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m16:59:13.936045 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:59:13.936797 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m16:59:13.956314 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m16:59:13.957479 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m16:59:13.957724 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m16:59:14.745373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.787 seconds
[0m16:59:14.748671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0bd70>]}
[0m16:59:14.749355 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.82s]
[0m16:59:14.749932 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m16:59:14.750333 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m16:59:14.750846 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m16:59:14.751336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m16:59:14.752134 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m16:59:14.810493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m16:59:14.811343 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m16:59:14.812918 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m16:59:14.813689 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m16:59:14.813899 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m16:59:15.628664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m16:59:15.633059 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f90890>]}
[0m16:59:15.634296 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.88s]
[0m16:59:15.635189 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m16:59:15.635687 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m16:59:15.636345 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:59:15.637039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m16:59:15.637469 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m16:59:15.647606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m16:59:15.648916 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m16:59:15.677715 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m16:59:15.678660 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:59:15.678877 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

        );
[0m16:59:17.381704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.702 seconds
[0m16:59:17.393224 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:59:17.400417 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m16:59:17.400766 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:59:17.457626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.056 seconds
[0m16:59:17.460254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb44e91b-0c11-43cc-a62e-80d204a7ad82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10964b230>]}
[0m16:59:17.460682 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 1.82s]
[0m16:59:17.461053 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m16:59:17.461898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:17.462132 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was left open.
[0m16:59:17.462356 [debug] [MainThread]: On model.dbtlearn.fct_reviews: Close
[0m16:59:17.548805 [info ] [MainThread]: 
[0m16:59:17.549573 [info ] [MainThread]: Finished running 1 incremental model, 2 table models, 3 view models in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m16:59:17.551220 [debug] [MainThread]: Command end result
[0m16:59:17.571187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m16:59:17.573083 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m16:59:17.578006 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m16:59:17.578266 [info ] [MainThread]: 
[0m16:59:17.578539 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:17.578742 [info ] [MainThread]: 
[0m16:59:17.578956 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m16:59:17.581047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8397326, "process_in_blocks": "0", "process_kernel_time": 0.201034, "process_mem_max_rss": "142245888", "process_out_blocks": "0", "process_user_time": 1.22183}
[0m16:59:17.581354 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:17.581290 after 5.84 seconds
[0m16:59:17.581603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdeb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082fcb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6fad0>]}
[0m16:59:17.581839 [debug] [MainThread]: Flushing usage events
[0m16:59:17.686815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:54.123351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632c3e0>]}


============================== 17:10:54.126446 | e7cce85a-a844-460c-b990-13e4fda46001 ==============================
[0m17:10:54.126446 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:10:54.126774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:54.305039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610d6a0>]}
[0m17:10:54.329973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d50350>]}
[0m17:10:54.330854 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:10:54.395389 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:10:54.439583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:10:54.439854 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/dim/dim_listings_w_hosts.sql
[0m17:10:54.538715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073fa330>]}
[0m17:10:54.561606 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:10:54.563206 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:10:54.572336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c0ec0>]}
[0m17:10:54.572548 [info ] [MainThread]: Found 7 models, 472 macros
[0m17:10:54.572704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a7350>]}
[0m17:10:54.573528 [info ] [MainThread]: 
[0m17:10:54.573698 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:54.573817 [info ] [MainThread]: 
[0m17:10:54.574024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:10:54.576059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:10:54.606697 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:10:54.606913 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:10:54.607061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:56.627368 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.020 seconds
[0m17:10:56.631813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:10:56.642996 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:10:56.643338 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m17:10:56.800211 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.156 seconds
[0m17:10:56.805254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102eda660>]}
[0m17:10:56.808968 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m17:10:56.809578 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.src_hosts ...................................... [RUN]
[0m17:10:56.810345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m17:10:56.810693 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m17:10:56.816911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m17:10:56.817991 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_hosts
[0m17:10:56.840604 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_hosts"
[0m17:10:56.841560 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_hosts"
[0m17:10:56.841794 [debug] [Thread-1 (]: On model.dbtlearn.src_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
  );
[0m17:10:57.129305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m17:10:57.158636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104922180>]}
[0m17:10:57.159452 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.35s]
[0m17:10:57.159963 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m17:10:57.160278 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:10:57.160735 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_listings ................................... [RUN]
[0m17:10:57.161575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m17:10:57.161895 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:10:57.163490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:10:57.164275 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_listings
[0m17:10:57.166346 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_listings"
[0m17:10:57.168440 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_listings"
[0m17:10:57.168984 [debug] [Thread-1 (]: On model.dbtlearn.src_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_listings"} */
create or replace   view AIRBNB.DEV.src_listings
  
   as (
    with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
  );
[0m17:10:57.671681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.499 seconds
[0m17:10:57.676226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a030d70>]}
[0m17:10:57.677352 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_listings .............................. [[32mSUCCESS 1[0m in 0.51s]
[0m17:10:57.678314 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:10:57.678811 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:10:57.679490 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_reviews .................................... [RUN]
[0m17:10:57.680146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:10:57.680589 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:10:57.683211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:10:57.684260 [debug] [Thread-1 (]: Began executing node model.dbtlearn.src_reviews
[0m17:10:57.687396 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.src_reviews"
[0m17:10:57.688530 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.src_reviews"
[0m17:10:57.688893 [debug] [Thread-1 (]: On model.dbtlearn.src_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
  );
[0m17:10:58.043342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m17:10:58.047273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02db50>]}
[0m17:10:58.048004 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.37s]
[0m17:10:58.048513 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:10:58.048869 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m17:10:58.049407 [info ] [Thread-1 (]: 4 of 7 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m17:10:58.050039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m17:10:58.050412 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m17:10:58.053469 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:10:58.054427 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m17:10:58.073974 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:10:58.074876 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m17:10:58.075134 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with src_hosts as (
    select * from AIRBNB.DEV.src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m17:10:59.501074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.425 seconds
[0m17:10:59.503777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0947a0>]}
[0m17:10:59.504418 [info ] [Thread-1 (]: 4 of 7 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.45s]
[0m17:10:59.504960 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m17:10:59.505409 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m17:10:59.506048 [info ] [Thread-1 (]: 5 of 7 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m17:10:59.506543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m17:10:59.506817 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m17:10:59.509763 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m17:10:59.510653 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m17:10:59.513449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m17:10:59.514636 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m17:10:59.514960 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with src_listings as (
    select * from AIRBNB.DEV.src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m17:11:00.564208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m17:11:00.568585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a128f20>]}
[0m17:11:00.569236 [info ] [Thread-1 (]: 5 of 7 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.06s]
[0m17:11:00.569745 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m17:11:00.570065 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m17:11:00.570533 [info ] [Thread-1 (]: 6 of 7 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:11:00.571199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m17:11:00.571703 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m17:11:00.582563 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m17:11:00.583364 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m17:11:00.611104 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:00.611523 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_reviews as (
    select * from AIRBNB.DEV.src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m17:11:00.835199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.223 seconds
[0m17:11:00.843396 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:00.843757 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:11:00.990829 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.147 seconds
[0m17:11:00.993759 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:00.994019 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m17:11:01.076700 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.082 seconds
[0m17:11:01.090776 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:01.091184 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:11:01.248967 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.157 seconds
[0m17:11:01.255430 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:01.256077 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m17:11:01.404106 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.148 seconds
[0m17:11:01.411039 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:11:01.421800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m17:11:01.422615 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:01.422836 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m17:11:01.607449 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m17:11:01.608034 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:01.608382 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m17:11:02.278422 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.669 seconds
[0m17:11:02.279876 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:02.280881 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m17:11:02.426820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m17:11:02.438141 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:11:02.444850 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:11:02.445178 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:11:02.569146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m17:11:02.573543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a133bc0>]}
[0m17:11:02.574444 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.00s]
[0m17:11:02.575729 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m17:11:02.576320 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m17:11:02.577065 [info ] [Thread-1 (]: 7 of 7 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m17:11:02.577727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m17:11:02.578164 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m17:11:02.581305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m17:11:02.582751 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m17:11:02.587120 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m17:11:02.588705 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m17:11:02.589088 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m17:11:03.371544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m17:11:03.376908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7cce85a-a844-460c-b990-13e4fda46001', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1467e0>]}
[0m17:11:03.377994 [info ] [Thread-1 (]: 7 of 7 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.80s]
[0m17:11:03.378743 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m17:11:03.380331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:03.380717 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was left open.
[0m17:11:03.381370 [debug] [MainThread]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m17:11:03.484845 [info ] [MainThread]: 
[0m17:11:03.485727 [info ] [MainThread]: Finished running 1 incremental model, 3 table models, 3 view models in 0 hours 0 minutes and 8.91 seconds (8.91s).
[0m17:11:03.487942 [debug] [MainThread]: Command end result
[0m17:11:03.509806 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:11:03.511563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:11:03.516170 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m17:11:03.516393 [info ] [MainThread]: 
[0m17:11:03.516649 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:03.516845 [info ] [MainThread]: 
[0m17:11:03.517038 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m17:11:03.519731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.428104, "process_in_blocks": "0", "process_kernel_time": 0.238403, "process_mem_max_rss": "145063936", "process_out_blocks": "0", "process_user_time": 1.440258}
[0m17:11:03.520021 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:03.519959 after 9.43 seconds
[0m17:11:03.520259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105746cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049500e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bf3e0>]}
[0m17:11:03.520485 [debug] [MainThread]: Flushing usage events
[0m17:11:03.715627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:34.490240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ee570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bfbf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c2c770>]}


============================== 17:12:34.493194 | 6f447821-1b83-4226-8c0b-281a186265eb ==============================
[0m17:12:34.493194 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:34.493499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:12:34.652169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2d4f0>]}
[0m17:12:34.676793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145b0530>]}
[0m17:12:34.677302 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:12:34.741097 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:34.769627 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:12:34.769889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113644950>]}
[0m17:12:35.208256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b656a0>]}
[0m17:12:35.233029 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:12:35.234422 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:12:35.244324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c13f20>]}
[0m17:12:35.244591 [info ] [MainThread]: Found 7 models, 472 macros
[0m17:12:35.244752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115c7b0e0>]}
[0m17:12:35.245634 [info ] [MainThread]: 
[0m17:12:35.245804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:35.245924 [info ] [MainThread]: 
[0m17:12:35.246175 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:12:35.248302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:12:35.275412 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:12:35.275616 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:12:35.275742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:35.890546 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.615 seconds
[0m17:12:35.895169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:12:35.906690 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:12:35.907023 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m17:12:36.031815 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.124 seconds
[0m17:12:36.035244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11452b950>]}
[0m17:12:36.037545 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m17:12:36.037898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m17:12:36.038412 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m17:12:36.043867 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m17:12:36.045638 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m17:12:36.045919 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:12:36.046249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m17:12:36.046574 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:12:36.047811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:12:36.048437 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:12:36.048693 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:12:36.048992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:12:36.049300 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:12:36.050689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:12:36.051274 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:12:36.051500 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m17:12:36.051823 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m17:12:36.052322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m17:12:36.052681 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m17:12:36.056575 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:12:36.057171 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m17:12:36.076445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:12:36.077326 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m17:12:36.077544 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m17:12:37.463434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.385 seconds
[0m17:12:37.480617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d2c4a0>]}
[0m17:12:37.481036 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.43s]
[0m17:12:37.481335 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m17:12:37.481515 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m17:12:37.481770 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m17:12:37.482042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m17:12:37.482206 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m17:12:37.486228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m17:12:37.486765 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m17:12:37.488164 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m17:12:37.488921 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m17:12:37.489108 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m17:12:38.309257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.820 seconds
[0m17:12:38.312472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11660a570>]}
[0m17:12:38.313188 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.83s]
[0m17:12:38.313783 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m17:12:38.314172 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m17:12:38.314719 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:12:38.315253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m17:12:38.315628 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m17:12:38.321510 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m17:12:38.322368 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m17:12:38.348455 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:38.348805 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m17:12:38.613530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.264 seconds
[0m17:12:38.622106 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:38.622368 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:12:38.727569 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.105 seconds
[0m17:12:38.733548 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:38.734140 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m17:12:38.807539 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.073 seconds
[0m17:12:38.822018 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:38.822573 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:12:38.907363 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.084 seconds
[0m17:12:38.912913 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:38.913423 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m17:12:39.038624 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.125 seconds
[0m17:12:39.047469 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:12:39.059350 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m17:12:39.060255 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:39.060455 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m17:12:39.245323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m17:12:39.246182 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:39.246827 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m17:12:39.963621 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.716 seconds
[0m17:12:39.964471 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:39.964978 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m17:12:40.291268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.326 seconds
[0m17:12:40.300545 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:12:40.305386 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:12:40.305801 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:12:40.808804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m17:12:40.812366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116429310>]}
[0m17:12:40.813168 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.50s]
[0m17:12:40.813839 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m17:12:40.814280 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m17:12:40.814802 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m17:12:40.815309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m17:12:40.815590 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m17:12:40.817480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m17:12:40.818055 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m17:12:40.819877 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m17:12:40.820726 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m17:12:40.821046 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m17:12:41.866414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.045 seconds
[0m17:12:41.869292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f447821-1b83-4226-8c0b-281a186265eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116676e40>]}
[0m17:12:41.870055 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m17:12:41.871283 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m17:12:41.872803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:41.873217 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was left open.
[0m17:12:41.873926 [debug] [MainThread]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m17:12:42.018124 [info ] [MainThread]: 
[0m17:12:42.018930 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m17:12:42.020347 [debug] [MainThread]: Command end result
[0m17:12:42.033343 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:12:42.034416 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:12:42.037722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m17:12:42.037941 [info ] [MainThread]: 
[0m17:12:42.038137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:42.038286 [info ] [MainThread]: 
[0m17:12:42.038442 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:12:42.040171 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.581298, "process_in_blocks": "0", "process_kernel_time": 0.223601, "process_mem_max_rss": "146505728", "process_out_blocks": "0", "process_user_time": 1.600001}
[0m17:12:42.040473 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:42.040420 after 7.58 seconds
[0m17:12:42.040672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11370f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145b00e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ecb00>]}
[0m17:12:42.040854 [debug] [MainThread]: Flushing usage events
[0m17:12:42.911598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:03.311982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034dfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106330440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063301a0>]}


============================== 17:14:03.314263 | 13542fb5-3517-4f1f-94b2-51cb5d00c4ec ==============================
[0m17:14:03.314263 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:14:03.314606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:14:03.451155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640cec0>]}
[0m17:14:03.474427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d00b0>]}
[0m17:14:03.474795 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:14:03.535506 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:14:03.573981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:14:03.574176 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:14:03.585738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9d460>]}
[0m17:14:03.612291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:14:03.613721 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:14:03.620614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071940b0>]}
[0m17:14:03.620879 [info ] [MainThread]: Found 7 models, 472 macros
[0m17:14:03.621042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718ffe0>]}
[0m17:14:03.621902 [info ] [MainThread]: 
[0m17:14:03.622070 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:14:03.622199 [info ] [MainThread]: 
[0m17:14:03.622432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:14:03.624498 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:14:03.651151 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:14:03.651358 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:14:03.651487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:14:04.153517 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.502 seconds
[0m17:14:04.157934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:14:04.168590 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:14:04.168970 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m17:14:04.262396 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.093 seconds
[0m17:14:04.267210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070235c0>]}
[0m17:14:04.269816 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m17:14:04.270226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m17:14:04.270568 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m17:14:04.278199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m17:14:04.279098 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m17:14:04.279418 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:14:04.279975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m17:14:04.280305 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:14:04.281763 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:14:04.282418 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:14:04.282693 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:14:04.282999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:14:04.283295 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:14:04.284907 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:14:04.285587 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:14:04.285868 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m17:14:04.286264 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m17:14:04.286566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m17:14:04.286780 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m17:14:04.290694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:14:04.291197 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m17:14:04.313070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:14:04.314074 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m17:14:04.314322 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m17:14:05.023335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.708 seconds
[0m17:14:05.044798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e74980>]}
[0m17:14:05.045413 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.76s]
[0m17:14:05.045906 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m17:14:05.046224 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m17:14:05.046660 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m17:14:05.047089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m17:14:05.047357 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m17:14:05.052742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m17:14:05.053343 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m17:14:05.055387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m17:14:05.056509 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m17:14:05.056899 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m17:14:05.847736 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m17:14:05.852601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b18e0>]}
[0m17:14:05.853440 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.81s]
[0m17:14:05.854061 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m17:14:05.854572 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m17:14:05.855298 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:14:05.856124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m17:14:05.856609 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m17:14:05.867525 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m17:14:05.940160 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m17:14:06.004351 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.004646 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m17:14:06.355295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.350 seconds
[0m17:14:06.367561 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.368057 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:14:06.463335 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.095 seconds
[0m17:14:06.468743 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.469246 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m17:14:06.589222 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.120 seconds
[0m17:14:06.601845 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.602187 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:14:06.686698 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.084 seconds
[0m17:14:06.688738 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.688927 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m17:14:06.783938 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.094 seconds
[0m17:14:06.794272 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:14:06.807797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m17:14:06.808762 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.809027 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m17:14:06.981931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.172 seconds
[0m17:14:06.983127 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:06.983677 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m17:14:07.447885 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.463 seconds
[0m17:14:07.449158 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:07.449732 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m17:14:07.654823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m17:14:07.666753 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:14:07.673081 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:14:07.673253 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:14:07.769558 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m17:14:07.772959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108172480>]}
[0m17:14:07.773652 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.92s]
[0m17:14:07.774150 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m17:14:07.774451 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m17:14:07.774685 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m17:14:07.774897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m17:14:07.775040 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m17:14:07.776415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m17:14:07.776813 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m17:14:07.777928 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m17:14:07.778608 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m17:14:07.778784 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m17:14:08.567094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m17:14:08.573408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13542fb5-3517-4f1f-94b2-51cb5d00c4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108193c20>]}
[0m17:14:08.573968 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.80s]
[0m17:14:08.574337 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m17:14:08.575147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:14:08.575433 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was left open.
[0m17:14:08.575706 [debug] [MainThread]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m17:14:08.740746 [info ] [MainThread]: 
[0m17:14:08.741250 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m17:14:08.742293 [debug] [MainThread]: Command end result
[0m17:14:08.762488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:14:08.764015 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:14:08.768314 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m17:14:08.768529 [info ] [MainThread]: 
[0m17:14:08.768770 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:14:08.768977 [info ] [MainThread]: 
[0m17:14:08.769181 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:14:08.771105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4877076, "process_in_blocks": "0", "process_kernel_time": 0.200404, "process_mem_max_rss": "142295040", "process_out_blocks": "0", "process_user_time": 1.262198}
[0m17:14:08.771417 [debug] [MainThread]: Command `dbt run` succeeded at 17:14:08.771355 after 5.49 seconds
[0m17:14:08.771666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034dfe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9fef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108143770>]}
[0m17:14:08.771903 [debug] [MainThread]: Flushing usage events
[0m17:14:08.866999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:50.308343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106896780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10752ff80>]}


============================== 17:26:50.312887 | 66622a45-795e-4fec-9259-32e54b5c0715 ==============================
[0m17:26:50.312887 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:26:50.313201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'profiles_dir': '/Users/amanarya/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:26:50.507537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755a510>]}
[0m17:26:50.531722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765c680>]}
[0m17:26:50.532332 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:26:50.596855 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:26:50.644146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:50.644341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:50.655508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6d0d0>]}
[0m17:26:50.679707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:26:50.681444 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:26:50.692219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082599a0>]}
[0m17:26:50.692425 [info ] [MainThread]: Found 7 models, 472 macros
[0m17:26:50.692583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827cbf0>]}
[0m17:26:50.693416 [info ] [MainThread]: 
[0m17:26:50.693590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:50.693710 [info ] [MainThread]: 
[0m17:26:50.693912 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:26:50.695911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:26:50.740619 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:26:50.740856 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:26:50.741090 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:51.179839 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.438 seconds
[0m17:26:51.183988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:26:51.194234 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:26:51.194605 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m17:26:51.327215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.132 seconds
[0m17:26:51.332015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797b560>]}
[0m17:26:51.336398 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m17:26:51.336926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m17:26:51.337242 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m17:26:51.345292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m17:26:51.346528 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m17:26:51.346841 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:26:51.347214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m17:26:51.347794 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:26:51.349294 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:26:51.350267 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:26:51.350550 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:26:51.350858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:26:51.351133 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:26:51.352489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:26:51.353248 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:26:51.353509 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m17:26:51.353871 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m17:26:51.354270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m17:26:51.354561 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m17:26:51.358630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:26:51.359412 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m17:26:51.381103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:26:51.382125 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m17:26:51.382375 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m17:26:52.395483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m17:26:52.421010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b9100>]}
[0m17:26:52.421602 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.06s]
[0m17:26:52.422092 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m17:26:52.422379 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m17:26:52.422752 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m17:26:52.423109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m17:26:52.423348 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m17:26:52.428562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m17:26:52.429554 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m17:26:52.431356 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m17:26:52.432385 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m17:26:52.432630 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m17:26:53.360625 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8406-0002-a577-0000-0007b49675e1
[0m17:26:53.360939 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m17:26:53.363381 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m17:26:53.363663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10943ff50>]}
[0m17:26:53.363990 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model DEV.dim_listings_cleansed ................ [[31mERROR[0m in 0.94s]
[0m17:26:53.364264 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m17:26:53.364438 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m17:26:53.364653 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_listings_cleansed' to be skipped because of status 'error'.  Reason: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql.
[0m17:26:53.364888 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:26:53.365679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m17:26:53.365861 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m17:26:53.371040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m17:26:53.371949 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m17:26:53.431955 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:53.432226 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m17:26:53.788908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m17:26:53.801609 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:53.802159 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:26:53.872257 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.069 seconds
[0m17:26:53.878854 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:53.879202 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m17:26:53.946776 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.067 seconds
[0m17:26:53.961298 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:53.961719 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:26:54.029308 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.067 seconds
[0m17:26:54.031980 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:54.032252 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m17:26:54.107792 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.075 seconds
[0m17:26:54.118603 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:26:54.130270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m17:26:54.132050 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:54.132281 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m17:26:54.355226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m17:26:54.356218 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:54.356744 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m17:26:54.744452 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.387 seconds
[0m17:26:54.745717 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:54.746235 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m17:26:54.880325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m17:26:54.893819 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:26:54.900568 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:26:54.900911 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:26:55.001540 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m17:26:55.006663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66622a45-795e-4fec-9259-32e54b5c0715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107005a60>]}
[0m17:26:55.007806 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.64s]
[0m17:26:55.008700 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m17:26:55.009326 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m17:26:55.009918 [info ] [Thread-1 (]: 4 of 4 SKIP relation DEV.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m17:26:55.010492 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m17:26:55.012079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:55.012632 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was left open.
[0m17:26:55.012945 [debug] [MainThread]: On model.dbtlearn.fct_reviews: Close
[0m17:26:55.105744 [info ] [MainThread]: 
[0m17:26:55.106240 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 4.41 seconds (4.41s).
[0m17:26:55.107123 [debug] [MainThread]: Command end result
[0m17:26:55.130311 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:26:55.132103 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:26:55.136759 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m17:26:55.136992 [info ] [MainThread]: 
[0m17:26:55.137238 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:26:55.137432 [info ] [MainThread]: 
[0m17:26:55.137666 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m17:26:55.137852 [info ] [MainThread]: 
[0m17:26:55.138037 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:26:55.140276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.863507, "process_in_blocks": "0", "process_kernel_time": 0.243058, "process_mem_max_rss": "141590528", "process_out_blocks": "0", "process_user_time": 1.267008}
[0m17:26:55.140576 [debug] [MainThread]: Command `dbt run` failed at 17:26:55.140517 after 4.86 seconds
[0m17:26:55.140821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094142f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109416450>]}
[0m17:26:55.141044 [debug] [MainThread]: Flushing usage events
[0m17:26:55.238242 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:22.243362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068105c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068102f0>]}


============================== 17:27:22.246536 | 2179f79d-30ff-40f4-b48c-1aab871c8e2d ==============================
[0m17:27:22.246536 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:22.246880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:27:22.382523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106823590>]}
[0m17:27:22.406370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107084b30>]}
[0m17:27:22.406729 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:27:22.467549 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:22.506998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:22.507201 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:22.518769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107434170>]}
[0m17:27:22.543715 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:27:22.545131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:27:22.551561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074d5b50>]}
[0m17:27:22.551769 [info ] [MainThread]: Found 7 models, 472 macros
[0m17:27:22.551924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10730fbc0>]}
[0m17:27:22.552772 [info ] [MainThread]: 
[0m17:27:22.552938 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:22.553063 [info ] [MainThread]: 
[0m17:27:22.553300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:27:22.555336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:27:22.581703 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:27:22.581918 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:27:22.582051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:23.070590 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.488 seconds
[0m17:27:23.074757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:27:23.085470 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:27:23.085776 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m17:27:23.310267 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.224 seconds
[0m17:27:23.314595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044768a0>]}
[0m17:27:23.315653 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m17:27:23.315819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m17:27:23.315952 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m17:27:23.319557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m17:27:23.320146 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m17:27:23.320334 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m17:27:23.320548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m17:27:23.320873 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m17:27:23.321711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m17:27:23.322110 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m17:27:23.322274 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m17:27:23.322475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m17:27:23.322685 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m17:27:23.323843 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m17:27:23.324331 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m17:27:23.324539 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m17:27:23.324828 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m17:27:23.325086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m17:27:23.325278 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m17:27:23.329246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:27:23.329766 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m17:27:23.353072 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m17:27:23.354549 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m17:27:23.354904 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m17:27:24.015817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m17:27:24.038837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108831700>]}
[0m17:27:24.039222 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.71s]
[0m17:27:24.039522 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m17:27:24.039710 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m17:27:24.039987 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m17:27:24.040258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m17:27:24.040440 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m17:27:24.044678 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m17:27:24.045279 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m17:27:24.047563 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m17:27:24.048866 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m17:27:24.049165 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m17:27:25.159662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8407-0002-a5a0-0000-0007b4966609
[0m17:27:25.160379 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m17:27:25.165338 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m17:27:25.165837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a5580>]}
[0m17:27:25.166483 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model DEV.dim_listings_cleansed ................ [[31mERROR[0m in 1.13s]
[0m17:27:25.167056 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m17:27:25.167412 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m17:27:25.167938 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_listings_cleansed' to be skipped because of status 'error'.  Reason: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql.
[0m17:27:25.168405 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:27:25.169520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m17:27:25.169796 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m17:27:25.179312 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m17:27:25.180379 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m17:27:25.243101 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:25.243405 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m17:27:25.537946 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.294 seconds
[0m17:27:25.550212 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:25.550808 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:27:25.618536 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.067 seconds
[0m17:27:25.624507 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:25.625099 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m17:27:25.716354 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.091 seconds
[0m17:27:25.736910 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:25.737469 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:27:25.807835 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.070 seconds
[0m17:27:25.813548 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:25.814099 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m17:27:25.885518 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.071 seconds
[0m17:27:25.899635 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:25.913002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m17:27:25.914097 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:25.914357 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m17:27:26.228859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.314 seconds
[0m17:27:26.229745 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:26.230181 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m17:27:26.411951 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.181 seconds
[0m17:27:26.413318 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:26.414201 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m17:27:26.578185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m17:27:26.583574 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:27:26.587644 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m17:27:26.588060 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:27:26.941120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.352 seconds
[0m17:27:26.945823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2179f79d-30ff-40f4-b48c-1aab871c8e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719d7c0>]}
[0m17:27:26.946806 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.78s]
[0m17:27:26.947524 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m17:27:26.947989 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m17:27:26.948586 [info ] [Thread-1 (]: 4 of 4 SKIP relation DEV.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m17:27:26.949198 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m17:27:26.950472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:26.950765 [debug] [MainThread]: Connection 'model.dbtlearn.fct_reviews' was left open.
[0m17:27:26.951026 [debug] [MainThread]: On model.dbtlearn.fct_reviews: Close
[0m17:27:27.073888 [info ] [MainThread]: 
[0m17:27:27.074291 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m17:27:27.074983 [debug] [MainThread]: Command end result
[0m17:27:27.091381 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m17:27:27.092787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m17:27:27.096636 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m17:27:27.096851 [info ] [MainThread]: 
[0m17:27:27.097065 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:27:27.097232 [info ] [MainThread]: 
[0m17:27:27.097429 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m17:27:27.097603 [info ] [MainThread]: 
[0m17:27:27.097766 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m17:27:27.099953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.8879666, "process_in_blocks": "0", "process_kernel_time": 0.195193, "process_mem_max_rss": "141885440", "process_out_blocks": "0", "process_user_time": 1.26008}
[0m17:27:27.100221 [debug] [MainThread]: Command `dbt run` failed at 17:27:27.100168 after 4.89 seconds
[0m17:27:27.100443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b441a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108533e30>]}
[0m17:27:27.100643 [debug] [MainThread]: Flushing usage events
[0m17:27:27.170564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:48.984766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11817f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11832c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11832c260>]}


============================== 18:09:48.989206 | dc9b9897-1f73-4345-8feb-a81716aedc2b ==============================
[0m18:09:48.989206 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:09:48.989507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:09:49.188296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1182d0350>]}
[0m18:09:49.213087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118727a70>]}
[0m18:09:49.213718 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:09:49.277724 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:09:49.305842 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:09:49.306100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c38dd0>]}
[0m18:09:49.729433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119817b30>]}
[0m18:09:49.752365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:09:49.753952 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:09:49.764805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199be930>]}
[0m18:09:49.765005 [info ] [MainThread]: Found 7 models, 472 macros
[0m18:09:49.765165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119814890>]}
[0m18:09:49.766012 [info ] [MainThread]: 
[0m18:09:49.766171 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:09:49.766290 [info ] [MainThread]: 
[0m18:09:49.766486 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:09:49.768340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:09:49.807523 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:09:49.807739 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:09:49.807876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:51.300332 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.492 seconds
[0m18:09:51.303784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV_dbt_aman)
[0m18:09:51.304640 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV_dbt_aman"
"
[0m18:09:51.309955 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV_dbt_aman"
[0m18:09:51.310293 [debug] [ThreadPool]: On create_AIRBNB_DEV_dbt_aman: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "create_AIRBNB_DEV_dbt_aman"} */
create schema if not exists AIRBNB.DEV_dbt_aman
[0m18:09:51.822345 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.512 seconds
[0m18:09:51.825780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV_dbt_aman, now list_AIRBNB_DEV_dbt_aman)
[0m18:09:51.838655 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV_dbt_aman"
[0m18:09:51.839179 [debug] [ThreadPool]: On list_AIRBNB_DEV_dbt_aman: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV_dbt_aman"} */
show objects in AIRBNB.DEV_dbt_aman limit 10000;
[0m18:09:52.158685 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.319 seconds
[0m18:09:52.162272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055daa80>]}
[0m18:09:52.167572 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:09:52.170009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV_dbt_aman, now model.dbtlearn.src_hosts)
[0m18:09:52.170405 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:09:52.177116 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:09:52.178351 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:09:52.178681 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:09:52.179033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:09:52.179338 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:09:52.180729 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:09:52.181448 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:09:52.181726 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:09:52.182027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:09:52.182295 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:09:52.183697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:09:52.184285 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:09:52.184516 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:09:52.184860 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV_dbt_aman.dim_hosts_cleansed ................... [RUN]
[0m18:09:52.185568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m18:09:52.185937 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:09:52.190470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:09:52.191755 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:09:52.213463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:09:52.214782 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:09:52.215035 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV_dbt_aman.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m18:09:53.377037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.161 seconds
[0m18:09:53.399852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10552c110>]}
[0m18:09:53.400394 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV_dbt_aman.dim_hosts_cleansed .............. [[32mSUCCESS 1[0m in 1.21s]
[0m18:09:53.400784 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:09:53.401031 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:09:53.401374 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV_dbt_aman.dim_listings_cleansed ................ [RUN]
[0m18:09:53.401730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:09:53.401953 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:09:53.406548 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:09:53.407342 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:09:53.409269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:09:53.410223 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m18:09:53.410468 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV_dbt_aman.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m18:09:54.452355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.041 seconds
[0m18:09:54.456890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af0aa80>]}
[0m18:09:54.458197 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV_dbt_aman.dim_listings_cleansed ........... [[32mSUCCESS 1[0m in 1.05s]
[0m18:09:54.459004 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:09:54.459482 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:09:54.460155 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV_dbt_aman.fct_reviews .................... [RUN]
[0m18:09:54.460929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:09:54.461357 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:09:54.467051 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:09:54.469455 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:09:54.499732 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:09:54.500695 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:09:54.500919 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace transient table AIRBNB.DEV_dbt_aman.fct_reviews
         as
        (

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

        );
[0m18:09:56.764735 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.263 seconds
[0m18:09:56.777483 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp
[0m18:09:56.784365 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:09:56.784705 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp cascade
[0m18:09:56.901335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m18:09:56.904826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2131a0>]}
[0m18:09:56.905811 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV_dbt_aman.fct_reviews ............... [[32mSUCCESS 1[0m in 2.44s]
[0m18:09:56.906671 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:09:56.907292 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:09:56.907995 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV_dbt_aman.dim_listings_w_hosts ................. [RUN]
[0m18:09:56.908673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:09:56.909142 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:09:56.914151 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:09:56.916066 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:09:56.919367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:09:56.921766 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:09:56.924206 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV_dbt_aman.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV_dbt_aman.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV_dbt_aman.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m18:09:57.835303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.910 seconds
[0m18:09:57.839725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc9b9897-1f73-4345-8feb-a81716aedc2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11af15760>]}
[0m18:09:57.840601 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV_dbt_aman.dim_listings_w_hosts ............ [[32mSUCCESS 1[0m in 0.93s]
[0m18:09:57.841248 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:09:57.843013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:57.843518 [debug] [MainThread]: Connection 'model.dbtlearn.dim_listings_w_hosts' was left open.
[0m18:09:57.843868 [debug] [MainThread]: On model.dbtlearn.dim_listings_w_hosts: Close
[0m18:09:57.926344 [info ] [MainThread]: 
[0m18:09:57.927004 [info ] [MainThread]: Finished running 1 incremental model, 3 table models in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m18:09:57.928347 [debug] [MainThread]: Command end result
[0m18:09:57.951332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:09:57.953103 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:09:57.957553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:09:57.957779 [info ] [MainThread]: 
[0m18:09:57.958034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:57.958235 [info ] [MainThread]: 
[0m18:09:57.958441 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:09:57.960595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.008122, "process_in_blocks": "0", "process_kernel_time": 0.248389, "process_mem_max_rss": "148291584", "process_out_blocks": "0", "process_user_time": 1.56814}
[0m18:09:57.960841 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:57.960793 after 9.01 seconds
[0m18:09:57.961044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11832c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10765bb30>]}
[0m18:09:57.961248 [debug] [MainThread]: Flushing usage events
[0m18:09:58.046894 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:49.576617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111741130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11252c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11252c170>]}


============================== 18:17:49.579458 | a91b4ccf-e60b-476e-b560-9174f5bb2949 ==============================
[0m18:17:49.579458 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:17:49.579768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:17:49.720204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136df140>]}
[0m18:17:49.745217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113b5b80>]}
[0m18:17:49.745751 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:17:49.806415 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:17:49.847399 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:17:49.847682 [debug] [MainThread]: Partial parsing: added file: dbtlearn://seeds/seed_full_moon_dates.csv
[0m18:17:49.943232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114787560>]}
[0m18:17:49.971991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:17:49.973494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:17:49.980797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114789a00>]}
[0m18:17:49.981049 [info ] [MainThread]: Found 7 models, 1 seed, 472 macros
[0m18:17:49.981208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148d5c10>]}
[0m18:17:49.982105 [info ] [MainThread]: 
[0m18:17:49.982313 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:49.982476 [info ] [MainThread]: 
[0m18:17:49.982750 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:17:49.983228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:17:50.008428 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:17:50.008636 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:17:50.008769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:50.478312 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.469 seconds
[0m18:17:50.488275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:17:50.498404 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:17:50.498771 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:17:50.692987 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.194 seconds
[0m18:17:50.696672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_DEV_dbt_aman)
[0m18:17:50.700587 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV_dbt_aman"
[0m18:17:50.701154 [debug] [ThreadPool]: On list_AIRBNB_DEV_dbt_aman: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV_dbt_aman"} */
show objects in AIRBNB.DEV_dbt_aman limit 10000;
[0m18:17:50.891572 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.190 seconds
[0m18:17:50.893832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a124e0>]}
[0m18:17:50.895440 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m18:17:50.895833 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m18:17:50.896161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV_dbt_aman, now seed.dbtlearn.seed_full_moon_dates)
[0m18:17:50.896433 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m18:17:50.896731 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m18:17:50.919644 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:17:50.920053 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (<?xml version="1.0" encoding="UTF-8"?> text)
[0m18:17:51.050116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8439-0002-a4fa-0000-0007b4969611
[0m18:17:51.050412 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 46 unexpected '<'.
[0m18:17:51.054020 [debug] [Thread-1 (]: Database Error in seed seed_full_moon_dates (seeds/seed_full_moon_dates.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 46 unexpected '<'.
[0m18:17:51.055198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a91b4ccf-e60b-476e-b560-9174f5bb2949', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f1a210>]}
[0m18:17:51.055985 [error] [Thread-1 (]: 1 of 1 ERROR loading seed file DEV.seed_full_moon_dates ........................ [[31mERROR[0m in 0.16s]
[0m18:17:51.056548 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m18:17:51.056970 [debug] [Thread-4 (]: Marking all children of 'seed.dbtlearn.seed_full_moon_dates' to be skipped because of status 'error'.  Reason: Database Error in seed seed_full_moon_dates (seeds/seed_full_moon_dates.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 46 unexpected '<'..
[0m18:17:51.058340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:51.058640 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was left open.
[0m18:17:51.058821 [debug] [MainThread]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m18:17:51.142132 [info ] [MainThread]: 
[0m18:17:51.142411 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m18:17:51.142753 [debug] [MainThread]: Command end result
[0m18:17:51.153880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:17:51.154761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:17:51.157529 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:17:51.157681 [info ] [MainThread]: 
[0m18:17:51.157853 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:17:51.157992 [info ] [MainThread]: 
[0m18:17:51.158150 [error] [MainThread]:   Database Error in seed seed_full_moon_dates (seeds/seed_full_moon_dates.csv)
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 46 unexpected '<'.
[0m18:17:51.158271 [info ] [MainThread]: 
[0m18:17:51.158405 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:17:51.159836 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.6125472, "process_in_blocks": "0", "process_kernel_time": 0.1916, "process_mem_max_rss": "143147008", "process_out_blocks": "0", "process_user_time": 1.116739}
[0m18:17:51.160106 [debug] [MainThread]: Command `dbt seed` failed at 18:17:51.160057 after 1.61 seconds
[0m18:17:51.160306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e9cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c255e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136dfbc0>]}
[0m18:17:51.160495 [debug] [MainThread]: Flushing usage events
[0m18:17:51.251950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:20:23.044605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b67200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cedd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070504a0>]}


============================== 18:20:23.047514 | 9a248511-64a4-495d-9171-8f70471bea2a ==============================
[0m18:20:23.047514 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:20:23.047823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:23.184653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768f470>]}
[0m18:20:23.209061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077c0bf0>]}
[0m18:20:23.209465 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:20:23.271500 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:20:23.315667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:23.315940 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://seeds/seed_full_moon_dates.csv
[0m18:20:23.402831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107848200>]}
[0m18:20:23.429942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:20:23.431332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:20:23.437854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d51760>]}
[0m18:20:23.438086 [info ] [MainThread]: Found 7 models, 1 seed, 472 macros
[0m18:20:23.438260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b617c0>]}
[0m18:20:23.439051 [info ] [MainThread]: 
[0m18:20:23.439213 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:23.439330 [info ] [MainThread]: 
[0m18:20:23.439542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:20:23.439908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:20:23.465202 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:20:23.465415 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:20:23.465544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:23.941329 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.476 seconds
[0m18:20:23.949795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:20:23.960779 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:20:23.961248 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:20:24.066520 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.105 seconds
[0m18:20:24.068401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_DEV_dbt_aman)
[0m18:20:24.070771 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV_dbt_aman"
[0m18:20:24.071103 [debug] [ThreadPool]: On list_AIRBNB_DEV_dbt_aman: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV_dbt_aman"} */
show objects in AIRBNB.DEV_dbt_aman limit 10000;
[0m18:20:24.152571 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.081 seconds
[0m18:20:24.155295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6c0e0>]}
[0m18:20:24.157397 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m18:20:24.157907 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m18:20:24.158313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV_dbt_aman, now seed.dbtlearn.seed_full_moon_dates)
[0m18:20:24.158587 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m18:20:24.158833 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m18:20:24.186349 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:20:24.186672 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (full_moon_date date)
[0m18:20:24.436929 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m18:20:24.455685 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:20:24.456120 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
BEGIN
[0m18:20:24.549637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m18:20:24.553059 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:20:24.553667 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s...
[0m18:20:25.403277 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 0.849 seconds
[0m18:20:25.404539 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearn.seed_full_moon_dates"
[0m18:20:25.404999 [debug] [Thread-1 (]: On seed.dbtlearn.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "seed.dbtlearn.seed_full_moon_dates"} */
COMMIT
[0m18:20:25.708726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m18:20:25.713971 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearn.seed_full_moon_dates"
[0m18:20:25.732402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a248511-64a4-495d-9171-8f70471bea2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdc4d0>]}
[0m18:20:25.732737 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 1.57s]
[0m18:20:25.733085 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m18:20:25.733753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:20:25.733919 [debug] [MainThread]: Connection 'seed.dbtlearn.seed_full_moon_dates' was left open.
[0m18:20:25.734076 [debug] [MainThread]: On seed.dbtlearn.seed_full_moon_dates: Close
[0m18:20:25.833221 [info ] [MainThread]: 
[0m18:20:25.833588 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m18:20:25.834095 [debug] [MainThread]: Command end result
[0m18:20:25.850103 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:20:25.851412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:20:25.855003 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:20:25.855195 [info ] [MainThread]: 
[0m18:20:25.855405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:20:25.855565 [info ] [MainThread]: 
[0m18:20:25.855725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:20:25.857318 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.84166, "process_in_blocks": "0", "process_kernel_time": 0.193837, "process_mem_max_rss": "142589952", "process_out_blocks": "0", "process_user_time": 1.163871}
[0m18:20:25.857620 [debug] [MainThread]: Command `dbt seed` succeeded at 18:20:25.857542 after 2.84 seconds
[0m18:20:25.857870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ccef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abb830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106380170>]}
[0m18:20:25.858098 [debug] [MainThread]: Flushing usage events
[0m18:20:25.941223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:17.262424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125c0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272c200>]}


============================== 18:26:17.265630 | 3ec80413-d52a-42d5-8ac2-2b35d6cf44da ==============================
[0m18:26:17.265630 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:26:17.265956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:17.436138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ec80413-d52a-42d5-8ac2-2b35d6cf44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692d100>]}
[0m18:26:17.461493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ec80413-d52a-42d5-8ac2-2b35d6cf44da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111435e80>]}
[0m18:26:17.462129 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:26:17.527025 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:26:17.576648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:26:17.576897 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m18:26:17.651093 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_fullmoon_reviews (models/mart/mart_fullmoon_reviews.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m18:26:17.652826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.42068422, "process_in_blocks": "0", "process_kernel_time": 0.172702, "process_mem_max_rss": "124076032", "process_out_blocks": "0", "process_user_time": 0.873349}
[0m18:26:17.653039 [debug] [MainThread]: Command `dbt run` failed at 18:26:17.652991 after 0.42 seconds
[0m18:26:17.653225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11272c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fad790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112037a70>]}
[0m18:26:17.653389 [debug] [MainThread]: Flushing usage events
[0m18:26:17.755323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:41.314980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109957fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b282f0>]}


============================== 18:26:41.318164 | 9bf792ca-5109-499a-9c9b-e9b4b85081d2 ==============================
[0m18:26:41.318164 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:26:41.318513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:41.452506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098471a0>]}
[0m18:26:41.475492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d03d70>]}
[0m18:26:41.475859 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:26:41.536834 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:26:41.581199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:26:41.581465 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/mart/mart_fullmoon_reviews.sql
[0m18:26:41.682236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abffe00>]}
[0m18:26:41.710034 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:26:41.711747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:26:41.721835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abe9b80>]}
[0m18:26:41.722053 [info ] [MainThread]: Found 8 models, 1 seed, 472 macros
[0m18:26:41.722209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7d970>]}
[0m18:26:41.723042 [info ] [MainThread]: 
[0m18:26:41.723214 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:41.723334 [info ] [MainThread]: 
[0m18:26:41.723542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:26:41.725616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:26:41.786444 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:26:41.787950 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:26:41.788095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:42.385679 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.597 seconds
[0m18:26:42.390477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:26:42.402208 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:26:42.402569 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:26:42.494345 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.091 seconds
[0m18:26:42.498921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_DEV_dbt_aman)
[0m18:26:42.502209 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV_dbt_aman"
[0m18:26:42.502495 [debug] [ThreadPool]: On list_AIRBNB_DEV_dbt_aman: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV_dbt_aman"} */
show objects in AIRBNB.DEV_dbt_aman limit 10000;
[0m18:26:42.663025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.160 seconds
[0m18:26:42.666610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9659d0>]}
[0m18:26:42.670280 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:26:42.670690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV_dbt_aman, now model.dbtlearn.src_hosts)
[0m18:26:42.671023 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:26:42.677460 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:26:42.678462 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:26:42.678772 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:26:42.679119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:26:42.679489 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:26:42.681089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:26:42.681896 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:26:42.682167 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:26:42.682451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:26:42.682698 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:26:42.685427 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:26:42.686091 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:26:42.686343 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:26:42.686695 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV_dbt_aman.dim_hosts_cleansed ................... [RUN]
[0m18:26:42.687393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m18:26:42.687752 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:26:42.692113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:26:42.692878 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:26:42.713299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:26:42.714255 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:26:42.714484 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV_dbt_aman.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m18:26:43.562218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.847 seconds
[0m18:26:43.590360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2c350>]}
[0m18:26:43.590970 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV_dbt_aman.dim_hosts_cleansed .............. [[32mSUCCESS 1[0m in 0.90s]
[0m18:26:43.591421 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:26:43.591711 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:26:43.592122 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV_dbt_aman.dim_listings_cleansed ................ [RUN]
[0m18:26:43.592530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:26:43.592798 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:26:43.597946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:26:43.598774 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:26:43.600646 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:26:43.601684 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m18:26:43.601949 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV_dbt_aman.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m18:26:44.615538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.013 seconds
[0m18:26:44.620408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be580b0>]}
[0m18:26:44.621355 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV_dbt_aman.dim_listings_cleansed ........... [[32mSUCCESS 1[0m in 1.03s]
[0m18:26:44.622019 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:26:44.623001 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:26:44.623855 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV_dbt_aman.fct_reviews .................... [RUN]
[0m18:26:44.624608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:26:44.625071 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:26:44.636639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:26:44.638281 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:26:44.668213 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:44.668529 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV_dbt_aman.fct_reviews)

  );
[0m18:26:45.035237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m18:26:45.050024 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:45.050595 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp
[0m18:26:45.111304 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.060 seconds
[0m18:26:45.117482 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:45.117951 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV_dbt_aman.fct_reviews
[0m18:26:45.198686 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.080 seconds
[0m18:26:45.211467 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:45.211903 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp
[0m18:26:45.275156 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.063 seconds
[0m18:26:45.278582 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:45.278993 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV_DBT_AMAN"."FCT_REVIEWS"
[0m18:26:45.347517 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.068 seconds
[0m18:26:45.360875 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV_DBT_AMAN"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:26:45.375399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:26:45.376493 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:45.376774 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m18:26:45.488841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:26:45.489576 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:45.490045 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV_dbt_aman.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp
        );
[0m18:26:46.230347 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.740 seconds
[0m18:26:46.231565 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:46.232203 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m18:26:46.476121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m18:26:46.482356 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp
[0m18:26:46.486870 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:26:46.487117 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV_dbt_aman.fct_reviews__dbt_tmp cascade
[0m18:26:46.576759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m18:26:46.578747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c813fe0>]}
[0m18:26:46.579284 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV_dbt_aman.fct_reviews ............... [[32mSUCCESS 0[0m in 1.95s]
[0m18:26:46.579758 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:26:46.580068 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:26:46.580467 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV_dbt_aman.dim_listings_w_hosts ................. [RUN]
[0m18:26:46.580878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:26:46.581153 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:26:46.583549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:26:46.585149 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:26:46.587366 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:26:46.588619 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:26:46.588914 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV_dbt_aman.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV_dbt_aman.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV_dbt_aman.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m18:26:47.460161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.871 seconds
[0m18:26:47.463845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c866750>]}
[0m18:26:47.464972 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV_dbt_aman.dim_listings_w_hosts ............ [[32mSUCCESS 1[0m in 0.88s]
[0m18:26:47.465867 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:26:47.466422 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:26:47.467286 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV_dbt_aman.mart_fullmoon_reviews ................ [RUN]
[0m18:26:47.467976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:26:47.468408 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:26:47.473961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:26:47.475298 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:26:47.478135 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:26:47.480044 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:26:47.480660 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV_dbt_aman.mart_fullmoon_reviews
         as
        (

WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV_dbt_aman.fct_reviews  -- Selecting all records from the fact reviews table
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates  -- Selecting all records from the full moon dates seed
)
SELECT
    r.*,  -- Selecting all columns from the fact reviews
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'  -- Checking if the full moon date is null
        ELSE 'full moon'  -- If not null, indicating it is a full moon
    END AS is_full_moon  -- Creating a new column to indicate full moon status
FROM
    fct_reviews r  -- Using the fact reviews as the main table
LEFT JOIN
    full_moon_dates fm  -- Left joining with the full moon dates
ON 
    (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))  -- Joining condition to match review dates with full moon dates
        );
[0m18:26:50.021489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.540 seconds
[0m18:26:50.028164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9bf792ca-5109-499a-9c9b-e9b4b85081d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8285c0>]}
[0m18:26:50.029038 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV_dbt_aman.mart_fullmoon_reviews ........... [[32mSUCCESS 1[0m in 2.56s]
[0m18:26:50.029725 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:26:50.030923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:50.031201 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was left open.
[0m18:26:50.031464 [debug] [MainThread]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:26:50.123093 [info ] [MainThread]: 
[0m18:26:50.124507 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 8.40 seconds (8.40s).
[0m18:26:50.125732 [debug] [MainThread]: Command end result
[0m18:26:50.147018 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:26:50.148753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:26:50.153250 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:26:50.153487 [info ] [MainThread]: 
[0m18:26:50.153782 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:50.153982 [info ] [MainThread]: 
[0m18:26:50.154197 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:26:50.156381 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.870418, "process_in_blocks": "0", "process_kernel_time": 0.227988, "process_mem_max_rss": "144818176", "process_out_blocks": "0", "process_user_time": 1.413421}
[0m18:26:50.156651 [debug] [MainThread]: Command `dbt run` succeeded at 18:26:50.156596 after 8.87 seconds
[0m18:26:50.156880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b28530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa719a0>]}
[0m18:26:50.157093 [debug] [MainThread]: Flushing usage events
[0m18:26:50.242096 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:30:07.456452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106028830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d81f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d81e50>]}


============================== 18:30:07.460126 | 2c75c0f2-f650-4deb-83f3-42aad08c6223 ==============================
[0m18:30:07.460126 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:30:07.460438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:30:07.507125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c75c0f2-f650-4deb-83f3-42aad08c6223', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e43500>]}
[0m18:30:07.521062 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.09579425, "process_in_blocks": "0", "process_kernel_time": 0.13069, "process_mem_max_rss": "103006208", "process_out_blocks": "0", "process_user_time": 0.657818}
[0m18:30:07.521378 [debug] [MainThread]: Command `dbt clean` succeeded at 18:30:07.521326 after 0.10 seconds
[0m18:30:07.521566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106657770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e43b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebe480>]}
[0m18:30:07.521733 [debug] [MainThread]: Flushing usage events
[0m18:30:07.612846 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:55.589817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2c3e0>]}


============================== 18:31:55.592633 | 247bda7a-3342-4cd6-9c6b-138ce2139bf3 ==============================
[0m18:31:55.592633 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:31:55.592948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:31:55.763239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5b500>]}
[0m18:31:55.786128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c524dd0>]}
[0m18:31:55.786800 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:31:55.851095 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:31:55.851605 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:31:55.851795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c600fe0>]}
[0m18:31:56.358444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8efb30>]}
[0m18:31:56.385948 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:31:56.387486 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:31:56.394734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8ccbf0>]}
[0m18:31:56.394949 [info ] [MainThread]: Found 8 models, 1 seed, 472 macros
[0m18:31:56.395103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8a9310>]}
[0m18:31:56.395965 [info ] [MainThread]: 
[0m18:31:56.396127 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:56.396245 [info ] [MainThread]: 
[0m18:31:56.396441 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:56.398446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:31:56.426504 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:31:56.426717 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:31:56.426847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:56.825713 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.399 seconds
[0m18:31:56.830011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:31:56.842236 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:31:56.843991 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:31:56.987592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.143 seconds
[0m18:31:56.990475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c97a420>]}
[0m18:31:56.993023 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:31:56.993393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m18:31:56.993680 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:31:56.999380 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:31:57.000530 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:31:57.000887 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:31:57.004658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:31:57.006631 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:31:57.010889 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:31:57.017315 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:31:57.017710 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:31:57.019134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:31:57.019838 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:31:57.026922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:31:57.030082 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:31:57.030623 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:31:57.031375 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m18:31:57.031965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m18:31:57.032256 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:31:57.047228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:31:57.050043 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:31:57.067227 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:31:57.068459 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:31:57.068664 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m18:31:58.055446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.986 seconds
[0m18:31:58.074792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2c3e0>]}
[0m18:31:58.075258 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.04s]
[0m18:31:58.075645 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:31:58.075894 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:31:58.076501 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m18:31:58.076762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:31:58.076967 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:31:58.081703 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:31:58.082386 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:31:58.085095 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:31:58.086195 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m18:31:58.086463 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m18:31:59.100532 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb8447-0002-a586-0000-0007b4964731
[0m18:31:59.101088 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003041 (42710): SQL compilation error:
Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
[0m18:31:59.104731 [debug] [Thread-1 (]: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m18:31:59.105191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11892ad20>]}
[0m18:31:59.105759 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model DEV.dim_listings_cleansed ................ [[31mERROR[0m in 1.03s]
[0m18:31:59.106236 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:31:59.106538 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:31:59.106930 [debug] [Thread-4 (]: Marking all children of 'model.dbtlearn.dim_listings_cleansed' to be skipped because of status 'error'.  Reason: Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql.
[0m18:31:59.107274 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m18:31:59.108177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:31:59.108447 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:31:59.114571 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:31:59.115304 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:31:59.142200 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:31:59.142452 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m18:31:59.477178 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.334 seconds
[0m18:31:59.489294 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:31:59.489785 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:31:59.579941 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.090 seconds
[0m18:31:59.586601 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:31:59.587202 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m18:31:59.700184 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.112 seconds
[0m18:31:59.717706 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:31:59.718250 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:31:59.804922 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.086 seconds
[0m18:31:59.811367 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:31:59.811795 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m18:31:59.901764 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.089 seconds
[0m18:31:59.913978 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:31:59.927935 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:31:59.928932 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:31:59.929211 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m18:32:00.054215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m18:32:00.054671 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:00.054969 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m18:32:00.358112 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.302 seconds
[0m18:32:00.359696 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:00.360268 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m18:32:00.471132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.110 seconds
[0m18:32:00.487999 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:32:00.494682 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:00.495009 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m18:32:00.629197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m18:32:00.635278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d090a0>]}
[0m18:32:00.636363 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.53s]
[0m18:32:00.637260 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:32:00.637684 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:32:00.638162 [info ] [Thread-1 (]: 4 of 5 SKIP relation DEV.dim_listings_w_hosts .................................. [[33mSKIP[0m]
[0m18:32:00.638559 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:32:00.639006 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:00.639497 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_fullmoon_reviews ......................... [RUN]
[0m18:32:00.639927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:32:00.640230 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:00.643284 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:32:00.644541 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:00.647097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:32:00.648143 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:32:00.648437 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV.mart_fullmoon_reviews
         as
        (

WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews  -- Selecting all records from the fact reviews table
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates  -- Selecting all records from the full moon dates seed
)
SELECT
    r.*,  -- Selecting all columns from the fact reviews
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'  -- Checking if the full moon date is null
        ELSE 'full moon'  -- If not null, indicating it is a full moon
    END AS is_full_moon  -- Creating a new column to indicate full moon status
FROM
    fct_reviews r  -- Using the fact reviews as the main table
LEFT JOIN
    full_moon_dates fm  -- Left joining with the full moon dates
ON 
    (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))  -- Joining condition to match review dates with full moon dates
        );
[0m18:32:02.909886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.261 seconds
[0m18:32:02.916252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247bda7a-3342-4cd6-9c6b-138ce2139bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d08170>]}
[0m18:32:02.917201 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 2.28s]
[0m18:32:02.917891 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:02.919800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:02.920436 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was left open.
[0m18:32:02.920801 [debug] [MainThread]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:32:03.048972 [info ] [MainThread]: 
[0m18:32:03.049867 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m18:32:03.051305 [debug] [MainThread]: Command end result
[0m18:32:03.068435 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:32:03.069623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:32:03.073632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:32:03.073873 [info ] [MainThread]: 
[0m18:32:03.074094 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:32:03.074280 [info ] [MainThread]: 
[0m18:32:03.074521 [error] [MainThread]:   Database Error in model dim_listings_cleansed (models/dim/dim_listings_cleansed.sql)
  003041 (42710): SQL compilation error:
  Table 'DIM_LISTINGS_CLEANSED' already exists, but current role has no privileges on it. If this is unexpected and you cannot resolve this problem, contact your system administrator. ACCOUNTADMIN role may be required to manage the privileges on the object.
  compiled code at target/run/dbtlearn/models/dim/dim_listings_cleansed.sql
[0m18:32:03.074698 [info ] [MainThread]: 
[0m18:32:03.074885 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m18:32:03.076659 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.5155663, "process_in_blocks": "0", "process_kernel_time": 0.220924, "process_mem_max_rss": "148078592", "process_out_blocks": "0", "process_user_time": 1.691413}
[0m18:32:03.076902 [debug] [MainThread]: Command `dbt run` failed at 18:32:03.076850 after 7.52 seconds
[0m18:32:03.077110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2c530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2c3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2c5f0>]}
[0m18:32:03.077304 [debug] [MainThread]: Flushing usage events
[0m18:32:03.161311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:49.058574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f05e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2c260>]}


============================== 18:32:49.061813 | 56e61099-d688-4b18-a2c0-77a2b023a3b7 ==============================
[0m18:32:49.061813 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:32:49.062134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:49.200883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d79e0>]}
[0m18:32:49.224686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106973140>]}
[0m18:32:49.225339 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:32:49.288229 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:32:49.337387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:32:49.337587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:32:49.352951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106973a10>]}
[0m18:32:49.381609 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:32:49.383014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:32:49.390910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5d640>]}
[0m18:32:49.391148 [info ] [MainThread]: Found 8 models, 1 seed, 472 macros
[0m18:32:49.391307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc93d0>]}
[0m18:32:49.392179 [info ] [MainThread]: 
[0m18:32:49.392343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:49.392468 [info ] [MainThread]: 
[0m18:32:49.392701 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:49.394784 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:32:49.424214 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:32:49.424430 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:32:49.424564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:49.843168 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.418 seconds
[0m18:32:49.847273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:32:49.860404 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:32:49.860899 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:32:49.945014 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.084 seconds
[0m18:32:49.949622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac0200>]}
[0m18:32:49.954262 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:32:49.954972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m18:32:49.955408 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:32:49.962657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:32:49.963774 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:32:49.964105 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:32:49.964648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:32:49.965057 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:32:49.966487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:32:49.967253 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:32:49.967533 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:32:49.967844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:32:49.968122 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:32:49.969644 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:32:49.970350 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:32:49.970629 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:32:49.971016 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m18:32:49.971416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m18:32:49.971688 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:32:49.975591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:32:49.976165 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:32:49.998088 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:32:49.999071 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:32:49.999308 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m18:32:50.759012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m18:32:50.787238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10310c350>]}
[0m18:32:50.787829 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.81s]
[0m18:32:50.788279 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:32:50.788560 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:32:50.788964 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m18:32:50.789360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:32:50.789639 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:32:50.794635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:32:50.795392 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:32:50.797344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:32:50.798493 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m18:32:50.798760 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.RAW.RAW_LISTINGS
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m18:32:51.598800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.799 seconds
[0m18:32:51.605668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105569c40>]}
[0m18:32:51.606651 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.82s]
[0m18:32:51.607283 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:32:51.607676 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:32:51.608236 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m18:32:51.608873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:32:51.609173 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:32:51.656903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:32:51.657700 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:32:51.680336 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:51.680578 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m18:32:51.908932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m18:32:51.921299 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:51.921786 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:32:52.036763 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.114 seconds
[0m18:32:52.042943 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.043740 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m18:32:52.147752 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.103 seconds
[0m18:32:52.165419 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.165900 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:32:52.270700 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.104 seconds
[0m18:32:52.276199 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.276853 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m18:32:52.364634 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.087 seconds
[0m18:32:52.376998 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:32:52.391477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:32:52.392874 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.393178 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m18:32:52.476832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m18:32:52.477468 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.477934 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m18:32:52.641019 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.162 seconds
[0m18:32:52.642356 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.643070 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m18:32:52.933544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m18:32:52.945198 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:32:52.950670 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:32:52.950939 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m18:32:53.095872 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m18:32:53.100274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f83c20>]}
[0m18:32:53.101179 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.49s]
[0m18:32:53.101871 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:32:53.102333 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:32:53.102932 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m18:32:53.103595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:32:53.103982 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:32:53.110684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:32:53.111865 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:32:53.115019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:32:53.116254 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:32:53.116602 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m18:32:54.269321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.152 seconds
[0m18:32:54.270955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f800e0>]}
[0m18:32:54.271375 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.17s]
[0m18:32:54.271742 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:32:54.271979 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:54.272323 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_fullmoon_reviews ......................... [RUN]
[0m18:32:54.272675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:32:54.272913 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:54.275225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:32:54.275826 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:54.277569 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:32:54.278655 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:32:54.278971 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV.mart_fullmoon_reviews
         as
        (

WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews  -- Selecting all records from the fact reviews table
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates  -- Selecting all records from the full moon dates seed
)
SELECT
    r.*,  -- Selecting all columns from the fact reviews
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'  -- Checking if the full moon date is null
        ELSE 'full moon'  -- If not null, indicating it is a full moon
    END AS is_full_moon  -- Creating a new column to indicate full moon status
FROM
    fct_reviews r  -- Using the fact reviews as the main table
LEFT JOIN
    full_moon_dates fm  -- Left joining with the full moon dates
ON 
    (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))  -- Joining condition to match review dates with full moon dates
        );
[0m18:32:55.963088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.683 seconds
[0m18:32:55.968807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56e61099-d688-4b18-a2c0-77a2b023a3b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0e090>]}
[0m18:32:55.969613 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 1.70s]
[0m18:32:55.970398 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:32:55.971831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:55.972116 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was left open.
[0m18:32:55.972378 [debug] [MainThread]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:32:56.060591 [info ] [MainThread]: 
[0m18:32:56.061188 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m18:32:56.062389 [debug] [MainThread]: Command end result
[0m18:32:56.083641 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:32:56.085070 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:32:56.089288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:32:56.089513 [info ] [MainThread]: 
[0m18:32:56.089755 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:56.089944 [info ] [MainThread]: 
[0m18:32:56.090130 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:32:56.092149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.064204, "process_in_blocks": "0", "process_kernel_time": 0.212925, "process_mem_max_rss": "141885440", "process_out_blocks": "0", "process_user_time": 1.321124}
[0m18:32:56.092391 [debug] [MainThread]: Command `dbt run` succeeded at 18:32:56.092339 after 7.06 seconds
[0m18:32:56.092608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10310cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c62ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688ab40>]}
[0m18:32:56.092823 [debug] [MainThread]: Flushing usage events
[0m18:32:56.182979 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:43.135003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ed7a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2c2c0>]}


============================== 18:41:43.143100 | 7ce83bfa-7d99-408a-b926-757cb7e61a13 ==============================
[0m18:41:43.143100 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:41:43.143430 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:43.344178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ce83bfa-7d99-408a-b926-757cb7e61a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87cf20>]}
[0m18:41:43.367489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ce83bfa-7d99-408a-b926-757cb7e61a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6ddb20>]}
[0m18:41:43.368028 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:41:43.432169 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:41:43.485625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m18:41:43.485901 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/sources.yml
[0m18:41:43.486079 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_hosts.sql
[0m18:41:43.486226 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_listings.sql
[0m18:41:43.486367 [debug] [MainThread]: Partial parsing: updated file: dbtlearn://models/src/src_reviews.sql
[0m18:41:43.632950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ce83bfa-7d99-408a-b926-757cb7e61a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aead940>]}
[0m18:41:43.691477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:41:43.693349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:41:43.704070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ce83bfa-7d99-408a-b926-757cb7e61a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeaee40>]}
[0m18:41:43.704284 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 472 macros
[0m18:41:43.704452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ce83bfa-7d99-408a-b926-757cb7e61a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0f6cf0>]}
[0m18:41:43.705288 [info ] [MainThread]: 
[0m18:41:43.705452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:43.705573 [info ] [MainThread]: 
[0m18:41:43.705776 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:43.707679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m18:41:43.750384 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:41:43.750624 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:41:43.750757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:44.288558 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.538 seconds
[0m18:41:44.293277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ce83bfa-7d99-408a-b926-757cb7e61a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be8aff0>]}
[0m18:41:44.296533 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:41:44.296944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m18:41:44.297238 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:41:44.305035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:41:44.306634 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:41:44.307064 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:41:44.307607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:41:44.307986 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:41:44.311845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:41:44.312848 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:41:44.313140 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:41:44.313519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:41:44.313860 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:41:44.316337 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:41:44.317167 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:41:44.317456 [debug] [Thread-1 (]: Began running node seed.dbtlearn.seed_full_moon_dates
[0m18:41:44.317740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now seed.dbtlearn.seed_full_moon_dates)
[0m18:41:44.318001 [debug] [Thread-1 (]: Began compiling node seed.dbtlearn.seed_full_moon_dates
[0m18:41:44.319414 [debug] [Thread-1 (]: Began executing node seed.dbtlearn.seed_full_moon_dates
[0m18:41:44.319795 [debug] [Thread-1 (]: Finished running node seed.dbtlearn.seed_full_moon_dates
[0m18:41:44.320007 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:41:44.320260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearn.seed_full_moon_dates, now model.dbtlearn.dim_hosts_cleansed)
[0m18:41:44.320571 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:41:44.324319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:41:44.324894 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:41:44.325305 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:41:44.325547 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:41:44.325857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:41:44.326164 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:41:44.330980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:41:44.331641 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:41:44.332001 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:41:44.332224 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:41:44.332441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:41:44.332651 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:41:44.338974 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:41:44.339513 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:41:44.339866 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:41:44.340078 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:41:44.340359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:41:44.340630 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:41:44.342507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:41:44.343401 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:41:44.343713 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:41:44.343926 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:41:44.344116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:41:44.344281 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:41:44.345979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:41:44.346506 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:41:44.346803 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:41:44.347524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:44.347698 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was left open.
[0m18:41:44.347850 [debug] [MainThread]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:41:44.441286 [debug] [MainThread]: Command end result
[0m18:41:44.459925 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:41:44.461186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:41:44.465451 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:41:44.468000 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.3653738, "process_in_blocks": "0", "process_kernel_time": 0.223289, "process_mem_max_rss": "140738560", "process_out_blocks": "0", "process_user_time": 1.183241}
[0m18:41:44.468262 [debug] [MainThread]: Command `dbt compile` succeeded at 18:41:44.468209 after 1.37 seconds
[0m18:41:44.468492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108044b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080441d0>]}
[0m18:41:44.468707 [debug] [MainThread]: Flushing usage events
[0m18:41:44.559396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:42:03.944424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10932c350>]}


============================== 18:42:03.947938 | 28c0207d-088a-44d4-8d22-12e1d977f282 ==============================
[0m18:42:03.947938 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:42:03.948256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:42:04.087465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bcc9e0>]}
[0m18:42:04.111609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797a0f0>]}
[0m18:42:04.112774 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:42:04.176168 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:42:04.240082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:42:04.240330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:42:04.262108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9eb10>]}
[0m18:42:04.300189 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:42:04.302048 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:42:04.312464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d5c70>]}
[0m18:42:04.312708 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 472 macros
[0m18:42:04.312868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e56d50>]}
[0m18:42:04.313891 [info ] [MainThread]: 
[0m18:42:04.314091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:04.314224 [info ] [MainThread]: 
[0m18:42:04.314492 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:42:04.316724 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:42:04.346714 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:42:04.346963 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:42:04.347110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:04.795246 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.448 seconds
[0m18:42:04.797155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:42:04.803920 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:42:04.805112 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m18:42:04.979060 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.160 seconds
[0m18:42:04.983498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8e8d0>]}
[0m18:42:04.987275 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m18:42:04.988031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m18:42:04.988490 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m18:42:04.996177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m18:42:04.997226 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m18:42:04.997559 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m18:42:04.997927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m18:42:04.998286 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m18:42:05.000612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m18:42:05.001362 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m18:42:05.001650 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m18:42:05.001970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m18:42:05.002255 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m18:42:05.004176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m18:42:05.004803 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m18:42:05.005061 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m18:42:05.005409 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m18:42:05.005752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m18:42:05.005991 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m18:42:05.009805 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:42:05.010368 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m18:42:05.031816 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m18:42:05.032793 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m18:42:05.033019 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.raw.raw_hosts
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m18:42:05.961602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.928 seconds
[0m18:42:05.986902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b431700>]}
[0m18:42:05.987484 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 0.98s]
[0m18:42:05.987925 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m18:42:05.988203 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m18:42:05.988596 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m18:42:05.988976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m18:42:05.989213 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m18:42:05.993973 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m18:42:05.994815 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m18:42:05.996829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m18:42:05.999841 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m18:42:06.000101 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.raw.raw_listings
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m18:42:06.743492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m18:42:06.746600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7940e0>]}
[0m18:42:06.747242 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 0.76s]
[0m18:42:06.747785 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m18:42:06.748146 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m18:42:06.748684 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m18:42:06.749229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m18:42:06.749683 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m18:42:06.813697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m18:42:06.814392 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m18:42:06.834476 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:06.834715 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.raw.raw_reviews
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m18:42:07.184254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m18:42:07.193408 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.193688 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:42:07.274454 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.080 seconds
[0m18:42:07.280445 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.280756 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m18:42:07.338133 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.057 seconds
[0m18:42:07.351846 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.352162 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:42:07.450595 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.098 seconds
[0m18:42:07.456296 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.456634 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m18:42:07.532720 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.076 seconds
[0m18:42:07.542146 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m18:42:07.551954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m18:42:07.553067 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.553408 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m18:42:07.653110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m18:42:07.653884 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.654423 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m18:42:07.801084 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.146 seconds
[0m18:42:07.802145 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.802668 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m18:42:07.960729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m18:42:07.969701 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m18:42:07.976656 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m18:42:07.977137 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m18:42:08.087224 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m18:42:08.091292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106afd820>]}
[0m18:42:08.092152 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 1.34s]
[0m18:42:08.092871 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m18:42:08.093329 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m18:42:08.093886 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m18:42:08.094289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m18:42:08.094489 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m18:42:08.096509 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:42:08.097115 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m18:42:08.098691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m18:42:08.100314 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m18:42:08.100748 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m18:42:08.784667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m18:42:08.787753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b78bda0>]}
[0m18:42:08.788584 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m18:42:08.789468 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m18:42:08.790068 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m18:42:08.790704 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_fullmoon_reviews ......................... [RUN]
[0m18:42:08.791236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m18:42:08.791639 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m18:42:08.794064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:42:08.794796 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m18:42:08.796619 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m18:42:08.797946 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m18:42:08.798220 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV.mart_fullmoon_reviews
         as
        (

WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews  -- Selecting all records from the fact reviews table
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates  -- Selecting all records from the full moon dates seed
)
SELECT
    r.*,  -- Selecting all columns from the fact reviews
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'  -- Checking if the full moon date is null
        ELSE 'full moon'  -- If not null, indicating it is a full moon
    END AS is_full_moon  -- Creating a new column to indicate full moon status
FROM
    fct_reviews r  -- Using the fact reviews as the main table
LEFT JOIN
    full_moon_dates fm  -- Left joining with the full moon dates
ON 
    (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))  -- Joining condition to match review dates with full moon dates
        );
[0m18:42:10.829092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.030 seconds
[0m18:42:10.833034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28c0207d-088a-44d4-8d22-12e1d977f282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6650a0>]}
[0m18:42:10.833813 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 2.04s]
[0m18:42:10.834534 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m18:42:10.835799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:10.836238 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was left open.
[0m18:42:10.836592 [debug] [MainThread]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m18:42:10.927963 [info ] [MainThread]: 
[0m18:42:10.928809 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m18:42:10.930373 [debug] [MainThread]: Command end result
[0m18:42:10.945956 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m18:42:10.947215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m18:42:10.954026 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m18:42:10.954713 [info ] [MainThread]: 
[0m18:42:10.955401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:10.956026 [info ] [MainThread]: 
[0m18:42:10.956300 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:42:10.958578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0482955, "process_in_blocks": "0", "process_kernel_time": 0.219847, "process_mem_max_rss": "142098432", "process_out_blocks": "0", "process_user_time": 1.330434}
[0m18:42:10.958957 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:10.958841 after 7.05 seconds
[0m18:42:10.959199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b227d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f1040>]}
[0m18:42:10.959393 [debug] [MainThread]: Flushing usage events
[0m18:42:11.046222 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:59.730031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952c560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10952c2c0>]}


============================== 13:38:59.736625 | 9c39a330-bb72-47b8-9b10-3f24c06e5842 ==============================
[0m13:38:59.736625 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:38:59.736970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:38:59.929817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c39a330-bb72-47b8-9b10-3f24c06e5842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10928a0c0>]}
[0m13:38:59.953080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c39a330-bb72-47b8-9b10-3f24c06e5842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994ab40>]}
[0m13:38:59.953530 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:39:00.024922 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:39:00.070274 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbtlearn: schema.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | models:
    3  |  - name: dim_listings_cleansed
    4  |  columns:
    5  |  - name: listing_id
    6  |  tests:
    7  |  - unique
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 2
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 2
[0m13:39:00.071954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.37674475, "process_in_blocks": "0", "process_kernel_time": 0.176187, "process_mem_max_rss": "122880000", "process_out_blocks": "0", "process_user_time": 0.829103}
[0m13:39:00.072198 [debug] [MainThread]: Command `dbt run` failed at 13:39:00.072149 after 0.38 seconds
[0m13:39:00.072394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d83770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097b7b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c9850>]}
[0m13:39:00.072573 [debug] [MainThread]: Flushing usage events
[0m13:39:00.162148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:19.897362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d24890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2c680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2c3e0>]}


============================== 13:39:19.900070 | 0afabc29-bff8-4710-b500-1ca6ece583bd ==============================
[0m13:39:19.900070 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:39:19.900532 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'profiles_dir': '/Users/amanarya/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:20.055495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd3320>]}
[0m13:39:20.079748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a23380>]}
[0m13:39:20.080242 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:39:20.142845 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:39:20.210352 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:39:20.210706 [debug] [MainThread]: Partial parsing: added file: dbtlearn://models/schema.yml
[0m13:39:20.332200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112acd010>]}
[0m13:39:20.375273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m13:39:20.377329 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m13:39:20.389183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c1a780>]}
[0m13:39:20.389452 [info ] [MainThread]: Found 8 models, 1 seed, 2 data tests, 3 sources, 472 macros
[0m13:39:20.389619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af58b0>]}
[0m13:39:20.390539 [info ] [MainThread]: 
[0m13:39:20.390695 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:20.390808 [info ] [MainThread]: 
[0m13:39:20.391016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:39:20.393052 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:39:20.464693 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:39:20.464937 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:39:20.465070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:21.185090 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.720 seconds
[0m13:39:21.189251 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:39:21.196605 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:39:21.196877 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m13:39:21.382071 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.185 seconds
[0m13:39:21.386830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112accf20>]}
[0m13:39:21.389993 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_hosts
[0m13:39:21.390339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.src_hosts)
[0m13:39:21.390532 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_hosts
[0m13:39:21.394958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_hosts"
[0m13:39:21.396010 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_hosts
[0m13:39:21.396224 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_listings
[0m13:39:21.396469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_hosts, now model.dbtlearn.src_listings)
[0m13:39:21.396716 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_listings
[0m13:39:21.398506 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_listings"
[0m13:39:21.399248 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_listings
[0m13:39:21.399441 [debug] [Thread-1 (]: Began running node model.dbtlearn.src_reviews
[0m13:39:21.399643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_listings, now model.dbtlearn.src_reviews)
[0m13:39:21.399815 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.src_reviews
[0m13:39:21.401273 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.src_reviews"
[0m13:39:21.401871 [debug] [Thread-1 (]: Finished running node model.dbtlearn.src_reviews
[0m13:39:21.402069 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_hosts_cleansed
[0m13:39:21.402332 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m13:39:21.402562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.src_reviews, now model.dbtlearn.dim_hosts_cleansed)
[0m13:39:21.402747 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_hosts_cleansed
[0m13:39:21.406520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:39:21.407355 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_hosts_cleansed
[0m13:39:21.425183 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_hosts_cleansed"
[0m13:39:21.426568 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_hosts_cleansed"
[0m13:39:21.426865 [debug] [Thread-1 (]: On model.dbtlearn.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (with  __dbt__cte__src_hosts as (
WITH raw_hosts AS (
    SELECT * FROM AIRBNB.raw.raw_hosts
)

SELECT
    id as host_id,
    name as host_name,
    is_superhost,
    created_at,
    updated_at
FROM raw_hosts
), src_hosts as (
    select * from __dbt__cte__src_hosts
)

select
    host_id,
    case 
        when host_name is null then 'Anonymous'  -- Replace null host_name with 'Anonymous'
        else host_name  -- Retain the original host_name if not null
    end as host_name,
    created_at,
    updated_at,
    is_superhost
from src_hosts
        );
[0m13:39:23.139743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.713 seconds
[0m13:39:23.153894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ca7fb0>]}
[0m13:39:23.154410 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.75s]
[0m13:39:23.154805 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_hosts_cleansed
[0m13:39:23.155093 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_cleansed
[0m13:39:23.155396 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m13:39:23.155672 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_hosts_cleansed, now model.dbtlearn.dim_listings_cleansed)
[0m13:39:23.155870 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_cleansed
[0m13:39:23.159685 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_cleansed"
[0m13:39:23.160608 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_cleansed
[0m13:39:23.162355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_cleansed"
[0m13:39:23.163640 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_cleansed"
[0m13:39:23.163909 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (with  __dbt__cte__src_listings as (
with raw_listings as (
    select * from AIRBNB.raw.raw_listings
)
select
    id as listing_id,
    name as listing_name,
    listing_url, room_type, minimum_nights, host_id,
    price as price_str,
    created_at, updated_at
from 
    raw_listings
), src_listings as (
    select * from __dbt__cte__src_listings
)

select
    listing_id, 
    listing_name,
    room_type,
    -- Adjust minimum_nights to ensure no listing has a value of 0
    case 
        when minimum_nights = 0 then 1  -- Set minimum_nights to 1 if it is currently 0
        else minimum_nights  -- Otherwise, keep the original minimum_nights value
    end as minimum_nights,
    host_id,
    -- Remove the dollar sign from the price string
    replace(
        price_str,
        '$'
    )::number(  -- Convert the resulting string to a number
        10,
        2
    ) as price,
    created_at,
    updated_at
from src_listings
        );
[0m13:39:24.324416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.160 seconds
[0m13:39:24.328029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113882510>]}
[0m13:39:24.328841 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.17s]
[0m13:39:24.329446 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_cleansed
[0m13:39:24.329840 [debug] [Thread-1 (]: Began running node model.dbtlearn.fct_reviews
[0m13:39:24.330363 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:39:24.330972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_cleansed, now model.dbtlearn.fct_reviews)
[0m13:39:24.331360 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.fct_reviews
[0m13:39:24.343014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.fct_reviews"
[0m13:39:24.344872 [debug] [Thread-1 (]: Began executing node model.dbtlearn.fct_reviews
[0m13:39:24.375662 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:24.375955 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
    SELECT * FROM AIRBNB.raw.raw_reviews
)

SELECT
    listing_id,
    date as review_date,
    reviewer_name,
    comments as review_text,
    sentiment as review_sentiment
FROM raw_reviews
), src_reviews as (
    select * from __dbt__cte__src_reviews
)

select * from src_reviews
where review_text is not null

    and review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m13:39:24.889141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m13:39:24.899216 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:24.899692 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:39:25.024785 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.124 seconds
[0m13:39:25.031190 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:25.031703 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m13:39:25.227855 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.196 seconds
[0m13:39:25.241645 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:25.242033 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:39:25.315468 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.073 seconds
[0m13:39:25.318228 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:25.318535 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:39:25.442608 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.124 seconds
[0m13:39:25.454922 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:39:25.469303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.fct_reviews"
[0m13:39:25.470549 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:25.470834 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:39:25.585225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m13:39:25.586407 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:25.586934 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m13:39:26.216885 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.629 seconds
[0m13:39:26.218249 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:26.218844 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
COMMIT
[0m13:39:26.448265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m13:39:26.462196 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:39:26.469132 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.fct_reviews"
[0m13:39:26.469488 [debug] [Thread-1 (]: On model.dbtlearn.fct_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:39:26.557098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m13:39:26.561064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11384ee10>]}
[0m13:39:26.561816 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.23s]
[0m13:39:26.562417 [debug] [Thread-1 (]: Finished running node model.dbtlearn.fct_reviews
[0m13:39:26.562831 [debug] [Thread-1 (]: Began running node model.dbtlearn.dim_listings_w_hosts
[0m13:39:26.563552 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m13:39:26.564238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.fct_reviews, now model.dbtlearn.dim_listings_w_hosts)
[0m13:39:26.564651 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.dim_listings_w_hosts
[0m13:39:26.567652 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.dim_listings_w_hosts"
[0m13:39:26.569116 [debug] [Thread-1 (]: Began executing node model.dbtlearn.dim_listings_w_hosts
[0m13:39:26.574128 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.dim_listings_w_hosts"
[0m13:39:26.576122 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.dim_listings_w_hosts"
[0m13:39:26.576606 [debug] [Thread-1 (]: On model.dbtlearn.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
    l AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_listings_cleansed
    ),
    h AS (
        SELECT
            *
        FROM
            AIRBNB.DEV.dim_hosts_cleansed
    )
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM
    l
LEFT JOIN
    h ON (h.host_id = l.host_id)
        );
[0m13:39:27.544952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.968 seconds
[0m13:39:27.548400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139274d0>]}
[0m13:39:27.549210 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 0.98s]
[0m13:39:27.549847 [debug] [Thread-1 (]: Finished running node model.dbtlearn.dim_listings_w_hosts
[0m13:39:27.550311 [debug] [Thread-1 (]: Began running node model.dbtlearn.mart_fullmoon_reviews
[0m13:39:27.550895 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_fullmoon_reviews ......................... [RUN]
[0m13:39:27.551435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearn.dim_listings_w_hosts, now model.dbtlearn.mart_fullmoon_reviews)
[0m13:39:27.552320 [debug] [Thread-1 (]: Began compiling node model.dbtlearn.mart_fullmoon_reviews
[0m13:39:27.557562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearn.mart_fullmoon_reviews"
[0m13:39:27.559926 [debug] [Thread-1 (]: Began executing node model.dbtlearn.mart_fullmoon_reviews
[0m13:39:27.562889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearn.mart_fullmoon_reviews"
[0m13:39:27.564625 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearn.mart_fullmoon_reviews"
[0m13:39:27.565023 [debug] [Thread-1 (]: On model.dbtlearn.mart_fullmoon_reviews: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.mart_fullmoon_reviews"} */
create or replace transient table AIRBNB.DEV.mart_fullmoon_reviews
         as
        (

WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews  -- Selecting all records from the fact reviews table
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates  -- Selecting all records from the full moon dates seed
)
SELECT
    r.*,  -- Selecting all columns from the fact reviews
    CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'  -- Checking if the full moon date is null
        ELSE 'full moon'  -- If not null, indicating it is a full moon
    END AS is_full_moon  -- Creating a new column to indicate full moon status
FROM
    fct_reviews r  -- Using the fact reviews as the main table
LEFT JOIN
    full_moon_dates fm  -- Left joining with the full moon dates
ON 
    (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))  -- Joining condition to match review dates with full moon dates
        );
[0m13:39:30.399714 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.834 seconds
[0m13:39:30.402570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0afabc29-bff8-4710-b500-1ca6ece583bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113936600>]}
[0m13:39:30.403287 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_fullmoon_reviews .................... [[32mSUCCESS 1[0m in 2.85s]
[0m13:39:30.403922 [debug] [Thread-1 (]: Finished running node model.dbtlearn.mart_fullmoon_reviews
[0m13:39:30.405135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:30.405497 [debug] [MainThread]: Connection 'model.dbtlearn.mart_fullmoon_reviews' was left open.
[0m13:39:30.405813 [debug] [MainThread]: On model.dbtlearn.mart_fullmoon_reviews: Close
[0m13:39:30.493900 [info ] [MainThread]: 
[0m13:39:30.494233 [info ] [MainThread]: Finished running 1 incremental model, 4 table models in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m13:39:30.494843 [debug] [MainThread]: Command end result
[0m13:39:30.506751 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m13:39:30.507702 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m13:39:30.511029 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m13:39:30.511187 [info ] [MainThread]: 
[0m13:39:30.511351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:30.511483 [info ] [MainThread]: 
[0m13:39:30.511620 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:39:30.512919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.646012, "process_in_blocks": "0", "process_kernel_time": 0.220793, "process_mem_max_rss": "145899520", "process_out_blocks": "0", "process_user_time": 1.422997}
[0m13:39:30.513100 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:30.513064 after 10.65 seconds
[0m13:39:30.513259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113933e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11387e360>]}
[0m13:39:30.513407 [debug] [MainThread]: Flushing usage events
[0m13:39:30.608565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:29.421894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071246b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107124410>]}


============================== 13:40:29.425164 | 027042ba-f823-48ab-8ef1-c5e643101116 ==============================
[0m13:40:29.425164 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:40:29.425513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:29.566516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '027042ba-f823-48ab-8ef1-c5e643101116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a7170>]}
[0m13:40:29.591234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '027042ba-f823-48ab-8ef1-c5e643101116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788a1b0>]}
[0m13:40:29.591674 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:40:29.652110 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:40:29.713150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:29.713406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:29.736886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '027042ba-f823-48ab-8ef1-c5e643101116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077dae40>]}
[0m13:40:29.777952 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m13:40:29.779455 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m13:40:29.793326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '027042ba-f823-48ab-8ef1-c5e643101116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2b8f0>]}
[0m13:40:29.793586 [info ] [MainThread]: Found 8 models, 1 seed, 2 data tests, 3 sources, 472 macros
[0m13:40:29.793750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027042ba-f823-48ab-8ef1-c5e643101116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107126420>]}
[0m13:40:29.794628 [info ] [MainThread]: 
[0m13:40:29.794796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:29.794915 [info ] [MainThread]: 
[0m13:40:29.795146 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:40:29.797233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m13:40:29.825574 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:40:29.825785 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m13:40:29.825921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:30.338465 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.512 seconds
[0m13:40:30.341189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027042ba-f823-48ab-8ef1-c5e643101116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10834d610>]}
[0m13:40:30.342881 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:40:30.343232 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:40:30.343596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m13:40:30.343862 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:40:30.356415 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:40:30.357118 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:40:30.405828 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:40:30.407265 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:40:30.407482 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:40:30.604367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m13:40:30.613186 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.27s]
[0m13:40:30.613788 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:40:30.614147 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:40:30.614541 [info ] [Thread-1 (]: 2 of 2 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:40:30.614979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m13:40:30.615299 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:40:30.621051 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:40:30.621822 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:40:30.623817 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:40:30.624758 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:40:30.625175 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:31.004031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.378 seconds
[0m13:40:31.009527 [info ] [Thread-1 (]: 2 of 2 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.39s]
[0m13:40:31.010384 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:40:31.011853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:31.012214 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was left open.
[0m13:40:31.012560 [debug] [MainThread]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:40:31.105271 [info ] [MainThread]: 
[0m13:40:31.106056 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.31 seconds (1.31s).
[0m13:40:31.107146 [debug] [MainThread]: Command end result
[0m13:40:31.130725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m13:40:31.132412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m13:40:31.137411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m13:40:31.137633 [info ] [MainThread]: 
[0m13:40:31.137882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:31.138087 [info ] [MainThread]: 
[0m13:40:31.138301 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:40:31.140205 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.7495351, "process_in_blocks": "0", "process_kernel_time": 0.193202, "process_mem_max_rss": "143015936", "process_out_blocks": "0", "process_user_time": 1.117545}
[0m13:40:31.140460 [debug] [MainThread]: Command `dbt test` succeeded at 13:40:31.140402 after 1.75 seconds
[0m13:40:31.140686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d6a50>]}
[0m13:40:31.140907 [debug] [MainThread]: Flushing usage events
[0m13:40:31.228164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:54:01.998394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d02990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc320>]}


============================== 13:54:02.005572 | b63bb46a-55ea-4bc6-8913-b78732c79eef ==============================
[0m13:54:02.005572 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:54:02.005902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'debug': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select dim_listings_cleansed', 'send_anonymous_usage_stats': 'True'}
[0m13:54:02.204313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b63bb46a-55ea-4bc6-8913-b78732c79eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de99a0>]}
[0m13:54:02.228048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b63bb46a-55ea-4bc6-8913-b78732c79eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105138dd0>]}
[0m13:54:02.228599 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m13:54:02.293495 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:54:02.360928 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m13:54:02.361235 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/consistent_created_at.sql
[0m13:54:02.361394 [debug] [MainThread]: Partial parsing: added file: dbtlearn://macros/no_nulls_in_columns.sql
[0m13:54:02.361523 [debug] [MainThread]: Partial parsing: added file: dbtlearn://tests/no_nulls_in_dim_listings.sql
[0m13:54:02.448476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b63bb46a-55ea-4bc6-8913-b78732c79eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562b2f0>]}
[0m13:54:02.491050 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m13:54:02.492859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m13:54:02.510875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b63bb46a-55ea-4bc6-8913-b78732c79eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dd040>]}
[0m13:54:02.511095 [info ] [MainThread]: Found 8 models, 1 seed, 4 data tests, 3 sources, 473 macros
[0m13:54:02.511255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b63bb46a-55ea-4bc6-8913-b78732c79eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500b4d0>]}
[0m13:54:02.512104 [info ] [MainThread]: 
[0m13:54:02.512288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:02.512411 [info ] [MainThread]: 
[0m13:54:02.512624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:54:02.514612 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m13:54:02.584265 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:54:02.584507 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000;
[0m13:54:02.584645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:03.154620 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.570 seconds
[0m13:54:03.159844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b63bb46a-55ea-4bc6-8913-b78732c79eef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10562ad20>]}
[0m13:54:03.162930 [debug] [Thread-1 (]: Began running node test.dbtlearn.consistent_created_at
[0m13:54:03.163304 [info ] [Thread-1 (]: 1 of 4 START test consistent_created_at ........................................ [RUN]
[0m13:54:03.163699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearn.consistent_created_at)
[0m13:54:03.164009 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.consistent_created_at
[0m13:54:03.172046 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.consistent_created_at"
[0m13:54:03.173284 [debug] [Thread-1 (]: Began executing node test.dbtlearn.consistent_created_at
[0m13:54:03.190502 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.consistent_created_at"
[0m13:54:03.191788 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.consistent_created_at"
[0m13:54:03.192086 [debug] [Thread-1 (]: On test.dbtlearn.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test to ensure that no review was submitted before its listing was created
SELECT
    r.listing_id,
    r.review_date,
    l.created_at as listing_created_at
FROM AIRBNB.DEV.fct_reviews r
LEFT JOIN AIRBNB.DEV.dim_listings_cleansed l
    ON r.listing_id = l.listing_id
WHERE r.review_date < l.created_at
      
    ) dbt_internal_test
[0m13:54:04.265656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m13:54:04.274937 [info ] [Thread-1 (]: 1 of 4 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.11s]
[0m13:54:04.275667 [debug] [Thread-1 (]: Finished running node test.dbtlearn.consistent_created_at
[0m13:54:04.276063 [debug] [Thread-1 (]: Began running node test.dbtlearn.no_nulls_in_dim_listings
[0m13:54:04.276487 [info ] [Thread-1 (]: 2 of 4 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m13:54:04.276950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.consistent_created_at, now test.dbtlearn.no_nulls_in_dim_listings)
[0m13:54:04.277262 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.no_nulls_in_dim_listings
[0m13:54:04.285439 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m13:54:04.285797 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
describe table AIRBNB.DEV.dim_listings_cleansed
[0m13:54:04.372868 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.086 seconds
[0m13:54:04.374885 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m13:54:04.375689 [debug] [Thread-1 (]: Began executing node test.dbtlearn.no_nulls_in_dim_listings
[0m13:54:04.378003 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.no_nulls_in_dim_listings"
[0m13:54:04.379064 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.no_nulls_in_dim_listings"
[0m13:54:04.379397 [debug] [Thread-1 (]: On test.dbtlearn.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- Test to ensure there are no null values in any column of dim_listings_cleansed

    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m13:54:04.762032 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m13:54:04.765410 [info ] [Thread-1 (]: 2 of 4 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 0.49s]
[0m13:54:04.766325 [debug] [Thread-1 (]: Finished running node test.dbtlearn.no_nulls_in_dim_listings
[0m13:54:04.766908 [debug] [Thread-1 (]: Began running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:54:04.767568 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m13:54:04.768395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.no_nulls_in_dim_listings, now test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m13:54:04.768902 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:54:04.781519 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:54:04.783222 [debug] [Thread-1 (]: Began executing node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:54:04.785723 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:54:04.786959 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m13:54:04.787298 [debug] [Thread-1 (]: On test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m13:54:04.908296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m13:54:04.911397 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.14s]
[0m13:54:04.912305 [debug] [Thread-1 (]: Finished running node test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m13:54:04.912850 [debug] [Thread-1 (]: Began running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:54:04.913375 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m13:54:04.914171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m13:54:04.914676 [debug] [Thread-1 (]: Began compiling node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:54:04.924800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:54:04.926259 [debug] [Thread-1 (]: Began executing node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:54:04.928247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:54:04.929563 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m13:54:04.929941 [debug] [Thread-1 (]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:54:05.052389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m13:54:05.056617 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.14s]
[0m13:54:05.057928 [debug] [Thread-1 (]: Finished running node test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m13:54:05.059825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:05.060301 [debug] [MainThread]: Connection 'test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e' was left open.
[0m13:54:05.060677 [debug] [MainThread]: On test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m13:54:05.151152 [info ] [MainThread]: 
[0m13:54:05.151958 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 2.64 seconds (2.64s).
[0m13:54:05.153304 [debug] [MainThread]: Command end result
[0m13:54:05.175555 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/manifest.json
[0m13:54:05.177063 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/semantic_manifest.json
[0m13:54:05.182306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/target/run_results.json
[0m13:54:05.182541 [info ] [MainThread]: 
[0m13:54:05.182783 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:05.182963 [info ] [MainThread]: 
[0m13:54:05.183162 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:54:05.185337 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.2198822, "process_in_blocks": "0", "process_kernel_time": 0.23465, "process_mem_max_rss": "143392768", "process_out_blocks": "0", "process_user_time": 1.234361}
[0m13:54:05.185622 [debug] [MainThread]: Command `dbt test` succeeded at 13:54:05.185560 after 3.22 seconds
[0m13:54:05.185868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049cc320>]}
[0m13:54:05.186100 [debug] [MainThread]: Flushing usage events
[0m13:54:05.270751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:45.716194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c41070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110afbfb0>]}


============================== 14:59:45.724501 | d53ffdd5-5c8e-40ae-92c4-b4ee9e195141 ==============================
[0m14:59:45.724501 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:59:45.724929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/amanarya/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/amanarya/Desktop/DE_Bootcamp/udemy_dbt_course/dbtlearn/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:59:45.781866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53ffdd5-5c8e-40ae-92c4-b4ee9e195141', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102564dd0>]}
[0m14:59:45.794380 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:59:45.794817 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:59:45.796468 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11646083, "process_in_blocks": "0", "process_kernel_time": 0.132615, "process_mem_max_rss": "102416384", "process_out_blocks": "0", "process_user_time": 0.657562}
[0m14:59:45.796795 [debug] [MainThread]: Command `dbt deps` succeeded at 14:59:45.796737 after 0.12 seconds
[0m14:59:45.796993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af81a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bb8d10>]}
[0m14:59:45.797175 [debug] [MainThread]: Flushing usage events
[0m14:59:45.883513 [debug] [MainThread]: An error was encountered while trying to flush usage events
